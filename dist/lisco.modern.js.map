{"version":3,"file":"lisco.modern.js","sources":["../src/common/Utils.js","../src/common/I18nLoader.js","../src/common/JsonResponse.js","../node_modules/safe-buffer/index.js","../node_modules/jws/lib/data-stream.js","../node_modules/buffer-equal-constant-time/index.js","../node_modules/ecdsa-sig-formatter/src/param-bytes-for-alg.js","../node_modules/ecdsa-sig-formatter/src/ecdsa-sig-formatter.js","../node_modules/jwa/index.js","../node_modules/jws/lib/tostring.js","../node_modules/jws/lib/sign-stream.js","../node_modules/jws/lib/verify-stream.js","../node_modules/jws/index.js","../node_modules/jsonwebtoken/lib/JsonWebTokenError.js","../node_modules/jsonwebtoken/lib/NotBeforeError.js","../node_modules/jsonwebtoken/lib/TokenExpiredError.js","../node_modules/ms/index.js","../node_modules/jsonwebtoken/lib/timespan.js","../node_modules/jsonwebtoken/node_modules/semver/internal/constants.js","../node_modules/jsonwebtoken/node_modules/semver/internal/debug.js","../node_modules/jsonwebtoken/node_modules/semver/internal/re.js","../node_modules/jsonwebtoken/node_modules/semver/internal/parse-options.js","../node_modules/jsonwebtoken/node_modules/semver/internal/identifiers.js","../node_modules/jsonwebtoken/node_modules/semver/classes/semver.js","../node_modules/jsonwebtoken/node_modules/semver/functions/compare.js","../node_modules/jsonwebtoken/node_modules/semver/functions/cmp.js","../node_modules/jsonwebtoken/node_modules/semver/functions/eq.js","../node_modules/jsonwebtoken/node_modules/semver/functions/neq.js","../node_modules/jsonwebtoken/node_modules/semver/functions/gt.js","../node_modules/jsonwebtoken/node_modules/semver/functions/gte.js","../node_modules/jsonwebtoken/node_modules/semver/functions/lt.js","../node_modules/jsonwebtoken/node_modules/semver/functions/lte.js","../node_modules/yallist/yallist.js","../node_modules/yallist/iterator.js","../node_modules/lru-cache/index.js","../node_modules/jsonwebtoken/node_modules/semver/classes/range.js","../node_modules/jsonwebtoken/node_modules/semver/classes/comparator.js","../node_modules/jsonwebtoken/node_modules/semver/ranges/subset.js","../node_modules/jsonwebtoken/node_modules/semver/index.js","../node_modules/jsonwebtoken/node_modules/semver/functions/satisfies.js","../node_modules/jsonwebtoken/lib/asymmetricKeyDetailsSupported.js","../node_modules/jsonwebtoken/lib/rsaPssKeyDetailsSupported.js","../node_modules/jsonwebtoken/lib/validateAsymmetricKey.js","../node_modules/jsonwebtoken/lib/psSupported.js","../node_modules/jsonwebtoken/verify.js","../node_modules/lodash.includes/index.js","../node_modules/lodash.isboolean/index.js","../node_modules/lodash.isinteger/index.js","../node_modules/lodash.isnumber/index.js","../node_modules/lodash.isplainobject/index.js","../node_modules/lodash.isstring/index.js","../node_modules/lodash.once/index.js","../node_modules/jsonwebtoken/sign.js","../node_modules/jsonwebtoken/index.js","../node_modules/jsonwebtoken/decode.js","../src/common/TokenGenerator.js","../src/server/Server.js","../src/server/ClusterServer.js","../src/events/EventHandler.js","../src/logger/Logger.js","../src/auth/AuthController.js","../src/auth/IAuthHandler.js","../src/auth/jwt/JwtAuthHandler.js","../src/auth/cookie/CookieAuthHandler.js","../src/db/knex/KnexConnector.js","../src/db/knex/filters/KnexFilterParser.js","../src/db/knex/dao/BaseKnexDao.js","../src/db/IUserDao.js","../src/base/BaseController.js","../src/base/BaseService.js","../src/App.js","../src/common/Runtime.js"],"sourcesContent":["import crypto from 'crypto';\r\nimport util from 'util';\r\n\r\nexport default class Utils {\r\n    static arrayToLower(mcArray) {\r\n        let tmp = mcArray.join('~').toLowerCase();\r\n        return tmp.split('~');\r\n    }\r\n\r\n    static replaceAll(str, find, replace) {\r\n        return str.replace(new RegExp(find.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&'), 'g'), replace);\r\n    }\r\n\r\n    /**\r\n     * Metodo de encript para las contraseñas y demas.\r\n     * \r\n     * @param {*} text \r\n     */\r\n    static encrypt(text) {\r\n        const algorithm = 'aes-256-cbc';\r\n        const secret = Buffer.from(process.env.CRYPT_SECRET, 'hex');\r\n        const iv = Buffer.from(process.env.CRYPT_IV, 'hex');\r\n\r\n        const cipher = crypto.createCipheriv(algorithm, secret, iv);\r\n        let encrypted = cipher.update(text);\r\n        encrypted = Buffer.concat([encrypted, cipher.final()]);\r\n        return encrypted.toString('hex');\r\n    }\r\n\r\n    /**\r\n     * Metodo de decrypt para las contraseñas y demas\r\n     * @param {*} text \r\n     */\r\n    static decrypt(text) {\r\n        const algorithm = 'aes-256-cbc';\r\n        const secret = Buffer.from(process.env.CRYPT_SECRET, 'hex');\r\n        const iv = Buffer.from(process.env.CRYPT_IV, 'hex');\r\n\r\n        const encryptedText = Buffer.from(text, 'hex');\r\n\r\n        const decipher = crypto.createDecipheriv(algorithm, secret, iv);\r\n        let decrypted = decipher.update(encryptedText);\r\n        decrypted = Buffer.concat([decrypted, decipher.final()]);\r\n        return decrypted.toString();\r\n    }\r\n\r\n\r\n    /**\r\n     * \r\n     * Utiliza una promise para ejecutar un setTimeout y hacer un falso sleep.\r\n     * \r\n     * @param {*} ms \r\n     */\r\n    static sleep(ms) {\r\n        let promise_sleep = util.promisify(setTimeout);\r\n\r\n        return promise_sleep(ms);\r\n    }\r\n\r\n    /**\r\n     * Genera dos claves para los metodos crypt y decrypt\r\n     */\r\n    static generateKeys() {\r\n        return {\r\n            key: crypto.randomBytes(32).toString('hex'),\r\n            iv: crypto.randomBytes(16).toString('hex')\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * \"aplana\" un objeto jerarquico en una estructura clave-valor.\r\n     * \r\n     * @param {*} ob \r\n     * @returns \r\n     */\r\n    static flattenObject(ob) {\r\n        let toReturn = {};\r\n        let flatObject;\r\n        for (let i in ob) {\r\n            if (!ob.hasOwnProperty(i)) {\r\n                continue;\r\n            }\r\n            //Devolver los arrays tal cual\r\n            if (ob[i] && Array === ob[i].constructor) {\r\n                toReturn[i] = ob[i];\r\n                continue;\r\n            }\r\n            if ((typeof ob[i]) === 'object') {\r\n                flatObject = Utils.flattenObject(ob[i]);\r\n                for (let x in flatObject) {\r\n                    if (!flatObject.hasOwnProperty(x)) {\r\n                        continue;\r\n                    }\r\n                    //Exclude arrays from the final result\r\n                    if (flatObject[x] && Array === flatObject.constructor) {\r\n                        continue;\r\n                    }\r\n                    toReturn[i + (!!isNaN(x) ? '.' + x : '')] = flatObject[x];\r\n                }\r\n            } else {\r\n                toReturn[i] = ob[i];\r\n            }\r\n        }\r\n        return toReturn;\r\n    }\r\n\r\n    /**\r\n     * Invierte un objeto aplanado recuperando su forma original\r\n     * \r\n     * @param {*} data \r\n     * @returns \r\n     */\r\n    static unflatten(data) {\r\n        var result = {}\r\n        for (var i in data) {\r\n            var keys = i.split('.')\r\n            keys.reduce(function (r, e, j) {\r\n                return r[e] || (r[e] = isNaN(Number(keys[j + 1])) ? (keys.length - 1 == j ? data[i] : {}) : [])\r\n            }, result)\r\n        }\r\n        return result\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @returns \r\n     */\r\n    static expressHandler() {\r\n\r\n        return (fn) => {\r\n            return function asyncUtilWrap(...args) {\r\n                const fnReturn = fn(...args);\r\n                const next = args[args.length - 1];\r\n                return Promise.resolve(fnReturn).catch((e) => {\r\n                    return next(e);\r\n                });\r\n            };\r\n        };\r\n    }\r\n}\r\n\r\n","import fs from \"fs\";\r\nimport util from \"util\";\r\nimport Utils from \"./Utils.js\";\r\n\r\nimport chokidar from \"chokidar\";\r\n\r\nexport default class I18nLoader {\r\n    constructor(disableWatchers) {\r\n        this.watcher = {};\r\n        this.disableWatchers = disableWatchers;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param lang\r\n     * @param callback\r\n     */\r\n    async load(custom) {\r\n        const lang = custom || process.env.DEFAULT_LANG;\r\n\r\n        if (!this.currentData) {\r\n            this.currentData = {};\r\n        }\r\n        if (!this.currentDataFlat) {\r\n            this.currentDataFlat = {};\r\n        }\r\n\r\n        const file = process.cwd() + \"/i18n/lang_\" + lang + \".json\";\r\n\r\n        if(!this.disableWatchers){\r\n            // Initialize watcher.\r\n            this.watcher[lang] = chokidar.watch(file, {\r\n                ignored: /(^|[/\\\\])\\../, // ignore dotfiles\r\n                persistent: true,\r\n            });\r\n            //Add change watcher\r\n            this.watcher[lang].on(\"change\", (path) => this.loadFile(path, lang));\r\n        }\r\n\r\n        //Initialize file load\r\n        await this.loadFile(file, lang);\r\n    }\r\n\r\n    /**\r\n     * Carga el archivo de traducciones.\r\n     *\r\n     * @param {*} file\r\n     * @param {*} lang\r\n     */\r\n    async loadFile(file, lang) {\r\n        const readfile = util.promisify(fs.readFile);\r\n        try {\r\n            const data = await readfile(file, \"utf8\");\r\n            var parsedData = JSON.parse(data);\r\n\r\n            this.currentDataFlat[lang] = Utils.flattenObject(parsedData);\r\n            this.currentData[lang] = parsedData;\r\n        } catch (ex) {\r\n            if (ex?.code === \"ENOENT\") {\r\n                return console.log(\"Lang file does not exist. Create it on ./i18n/lang_{xx}.json\");\r\n            }\r\n            console.error(ex);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {*} key\r\n     */\r\n    async translate(key, lang) {\r\n        if (!lang) lang = process.env.DEFAULT_LANG;\r\n\r\n        if (this.currentDataFlat && this.currentDataFlat[lang] && this.currentDataFlat[lang][key]) {\r\n            return this.currentData[lang][key];\r\n        }\r\n\r\n        if (!this.currentDataFlat || !this.currentDataFlat[lang]) {\r\n            await this.load(lang);\r\n            if (this.currentDataFlat && this.currentDataFlat[lang] && this.currentDataFlat[key]) {\r\n                return this.currentDataFlat[lang][key];\r\n            }\r\n        }\r\n        return \"undefined.\" + key;\r\n    }\r\n}\r\n","export default class JsonResponse {\r\n    constructor(success, data, message, total) {\r\n        this.data = data;\r\n        this.success = success;\r\n        this.total = total;\r\n        this.message = message || '';\r\n    }\r\n\r\n    toJson() {\r\n        return (this);\r\n    }\r\n}\r\n","/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\n// alternative to using Object.keys for old browsers\nfunction copyProps (src, dst) {\n  for (var key in src) {\n    dst[key] = src[key]\n  }\n}\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  copyProps(buffer, exports)\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\n// Copy static methods from Buffer\ncopyProps(Buffer, SafeBuffer)\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","/*global module, process*/\nvar Buffer = require('safe-buffer').Buffer;\nvar Stream = require('stream');\nvar util = require('util');\n\nfunction DataStream(data) {\n  this.buffer = null;\n  this.writable = true;\n  this.readable = true;\n\n  // No input\n  if (!data) {\n    this.buffer = Buffer.alloc(0);\n    return this;\n  }\n\n  // Stream\n  if (typeof data.pipe === 'function') {\n    this.buffer = Buffer.alloc(0);\n    data.pipe(this);\n    return this;\n  }\n\n  // Buffer or String\n  // or Object (assumedly a passworded key)\n  if (data.length || typeof data === 'object') {\n    this.buffer = data;\n    this.writable = false;\n    process.nextTick(function () {\n      this.emit('end', data);\n      this.readable = false;\n      this.emit('close');\n    }.bind(this));\n    return this;\n  }\n\n  throw new TypeError('Unexpected data type ('+ typeof data + ')');\n}\nutil.inherits(DataStream, Stream);\n\nDataStream.prototype.write = function write(data) {\n  this.buffer = Buffer.concat([this.buffer, Buffer.from(data)]);\n  this.emit('data', data);\n};\n\nDataStream.prototype.end = function end(data) {\n  if (data)\n    this.write(data);\n  this.emit('end', data);\n  this.emit('close');\n  this.writable = false;\n  this.readable = false;\n};\n\nmodule.exports = DataStream;\n","/*jshint node:true */\n'use strict';\nvar Buffer = require('buffer').Buffer; // browserify\nvar SlowBuffer = require('buffer').SlowBuffer;\n\nmodule.exports = bufferEq;\n\nfunction bufferEq(a, b) {\n\n  // shortcutting on type is necessary for correctness\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    return false;\n  }\n\n  // buffer sizes should be well-known information, so despite this\n  // shortcutting, it doesn't leak any information about the *contents* of the\n  // buffers.\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  var c = 0;\n  for (var i = 0; i < a.length; i++) {\n    /*jshint bitwise:false */\n    c |= a[i] ^ b[i]; // XOR\n  }\n  return c === 0;\n}\n\nbufferEq.install = function() {\n  Buffer.prototype.equal = SlowBuffer.prototype.equal = function equal(that) {\n    return bufferEq(this, that);\n  };\n};\n\nvar origBufEqual = Buffer.prototype.equal;\nvar origSlowBufEqual = SlowBuffer.prototype.equal;\nbufferEq.restore = function() {\n  Buffer.prototype.equal = origBufEqual;\n  SlowBuffer.prototype.equal = origSlowBufEqual;\n};\n","'use strict';\n\nfunction getParamSize(keySize) {\n\tvar result = ((keySize / 8) | 0) + (keySize % 8 === 0 ? 0 : 1);\n\treturn result;\n}\n\nvar paramBytesForAlg = {\n\tES256: getParamSize(256),\n\tES384: getParamSize(384),\n\tES512: getParamSize(521)\n};\n\nfunction getParamBytesForAlg(alg) {\n\tvar paramBytes = paramBytesForAlg[alg];\n\tif (paramBytes) {\n\t\treturn paramBytes;\n\t}\n\n\tthrow new Error('Unknown algorithm \"' + alg + '\"');\n}\n\nmodule.exports = getParamBytesForAlg;\n","'use strict';\n\nvar Buffer = require('safe-buffer').Buffer;\n\nvar getParamBytesForAlg = require('./param-bytes-for-alg');\n\nvar MAX_OCTET = 0x80,\n\tCLASS_UNIVERSAL = 0,\n\tPRIMITIVE_BIT = 0x20,\n\tTAG_SEQ = 0x10,\n\tTAG_INT = 0x02,\n\tENCODED_TAG_SEQ = (TAG_SEQ | PRIMITIVE_BIT) | (CLASS_UNIVERSAL << 6),\n\tENCODED_TAG_INT = TAG_INT | (CLASS_UNIVERSAL << 6);\n\nfunction base64Url(base64) {\n\treturn base64\n\t\t.replace(/=/g, '')\n\t\t.replace(/\\+/g, '-')\n\t\t.replace(/\\//g, '_');\n}\n\nfunction signatureAsBuffer(signature) {\n\tif (Buffer.isBuffer(signature)) {\n\t\treturn signature;\n\t} else if ('string' === typeof signature) {\n\t\treturn Buffer.from(signature, 'base64');\n\t}\n\n\tthrow new TypeError('ECDSA signature must be a Base64 string or a Buffer');\n}\n\nfunction derToJose(signature, alg) {\n\tsignature = signatureAsBuffer(signature);\n\tvar paramBytes = getParamBytesForAlg(alg);\n\n\t// the DER encoded param should at most be the param size, plus a padding\n\t// zero, since due to being a signed integer\n\tvar maxEncodedParamLength = paramBytes + 1;\n\n\tvar inputLength = signature.length;\n\n\tvar offset = 0;\n\tif (signature[offset++] !== ENCODED_TAG_SEQ) {\n\t\tthrow new Error('Could not find expected \"seq\"');\n\t}\n\n\tvar seqLength = signature[offset++];\n\tif (seqLength === (MAX_OCTET | 1)) {\n\t\tseqLength = signature[offset++];\n\t}\n\n\tif (inputLength - offset < seqLength) {\n\t\tthrow new Error('\"seq\" specified length of \"' + seqLength + '\", only \"' + (inputLength - offset) + '\" remaining');\n\t}\n\n\tif (signature[offset++] !== ENCODED_TAG_INT) {\n\t\tthrow new Error('Could not find expected \"int\" for \"r\"');\n\t}\n\n\tvar rLength = signature[offset++];\n\n\tif (inputLength - offset - 2 < rLength) {\n\t\tthrow new Error('\"r\" specified length of \"' + rLength + '\", only \"' + (inputLength - offset - 2) + '\" available');\n\t}\n\n\tif (maxEncodedParamLength < rLength) {\n\t\tthrow new Error('\"r\" specified length of \"' + rLength + '\", max of \"' + maxEncodedParamLength + '\" is acceptable');\n\t}\n\n\tvar rOffset = offset;\n\toffset += rLength;\n\n\tif (signature[offset++] !== ENCODED_TAG_INT) {\n\t\tthrow new Error('Could not find expected \"int\" for \"s\"');\n\t}\n\n\tvar sLength = signature[offset++];\n\n\tif (inputLength - offset !== sLength) {\n\t\tthrow new Error('\"s\" specified length of \"' + sLength + '\", expected \"' + (inputLength - offset) + '\"');\n\t}\n\n\tif (maxEncodedParamLength < sLength) {\n\t\tthrow new Error('\"s\" specified length of \"' + sLength + '\", max of \"' + maxEncodedParamLength + '\" is acceptable');\n\t}\n\n\tvar sOffset = offset;\n\toffset += sLength;\n\n\tif (offset !== inputLength) {\n\t\tthrow new Error('Expected to consume entire buffer, but \"' + (inputLength - offset) + '\" bytes remain');\n\t}\n\n\tvar rPadding = paramBytes - rLength,\n\t\tsPadding = paramBytes - sLength;\n\n\tvar dst = Buffer.allocUnsafe(rPadding + rLength + sPadding + sLength);\n\n\tfor (offset = 0; offset < rPadding; ++offset) {\n\t\tdst[offset] = 0;\n\t}\n\tsignature.copy(dst, offset, rOffset + Math.max(-rPadding, 0), rOffset + rLength);\n\n\toffset = paramBytes;\n\n\tfor (var o = offset; offset < o + sPadding; ++offset) {\n\t\tdst[offset] = 0;\n\t}\n\tsignature.copy(dst, offset, sOffset + Math.max(-sPadding, 0), sOffset + sLength);\n\n\tdst = dst.toString('base64');\n\tdst = base64Url(dst);\n\n\treturn dst;\n}\n\nfunction countPadding(buf, start, stop) {\n\tvar padding = 0;\n\twhile (start + padding < stop && buf[start + padding] === 0) {\n\t\t++padding;\n\t}\n\n\tvar needsSign = buf[start + padding] >= MAX_OCTET;\n\tif (needsSign) {\n\t\t--padding;\n\t}\n\n\treturn padding;\n}\n\nfunction joseToDer(signature, alg) {\n\tsignature = signatureAsBuffer(signature);\n\tvar paramBytes = getParamBytesForAlg(alg);\n\n\tvar signatureBytes = signature.length;\n\tif (signatureBytes !== paramBytes * 2) {\n\t\tthrow new TypeError('\"' + alg + '\" signatures must be \"' + paramBytes * 2 + '\" bytes, saw \"' + signatureBytes + '\"');\n\t}\n\n\tvar rPadding = countPadding(signature, 0, paramBytes);\n\tvar sPadding = countPadding(signature, paramBytes, signature.length);\n\tvar rLength = paramBytes - rPadding;\n\tvar sLength = paramBytes - sPadding;\n\n\tvar rsBytes = 1 + 1 + rLength + 1 + 1 + sLength;\n\n\tvar shortLength = rsBytes < MAX_OCTET;\n\n\tvar dst = Buffer.allocUnsafe((shortLength ? 2 : 3) + rsBytes);\n\n\tvar offset = 0;\n\tdst[offset++] = ENCODED_TAG_SEQ;\n\tif (shortLength) {\n\t\t// Bit 8 has value \"0\"\n\t\t// bits 7-1 give the length.\n\t\tdst[offset++] = rsBytes;\n\t} else {\n\t\t// Bit 8 of first octet has value \"1\"\n\t\t// bits 7-1 give the number of additional length octets.\n\t\tdst[offset++] = MAX_OCTET\t| 1;\n\t\t// length, base 256\n\t\tdst[offset++] = rsBytes & 0xff;\n\t}\n\tdst[offset++] = ENCODED_TAG_INT;\n\tdst[offset++] = rLength;\n\tif (rPadding < 0) {\n\t\tdst[offset++] = 0;\n\t\toffset += signature.copy(dst, offset, 0, paramBytes);\n\t} else {\n\t\toffset += signature.copy(dst, offset, rPadding, paramBytes);\n\t}\n\tdst[offset++] = ENCODED_TAG_INT;\n\tdst[offset++] = sLength;\n\tif (sPadding < 0) {\n\t\tdst[offset++] = 0;\n\t\tsignature.copy(dst, offset, paramBytes);\n\t} else {\n\t\tsignature.copy(dst, offset, paramBytes + sPadding);\n\t}\n\n\treturn dst;\n}\n\nmodule.exports = {\n\tderToJose: derToJose,\n\tjoseToDer: joseToDer\n};\n","var bufferEqual = require('buffer-equal-constant-time');\nvar Buffer = require('safe-buffer').Buffer;\nvar crypto = require('crypto');\nvar formatEcdsa = require('ecdsa-sig-formatter');\nvar util = require('util');\n\nvar MSG_INVALID_ALGORITHM = '\"%s\" is not a valid algorithm.\\n  Supported algorithms are:\\n  \"HS256\", \"HS384\", \"HS512\", \"RS256\", \"RS384\", \"RS512\", \"PS256\", \"PS384\", \"PS512\", \"ES256\", \"ES384\", \"ES512\" and \"none\".'\nvar MSG_INVALID_SECRET = 'secret must be a string or buffer';\nvar MSG_INVALID_VERIFIER_KEY = 'key must be a string or a buffer';\nvar MSG_INVALID_SIGNER_KEY = 'key must be a string, a buffer or an object';\n\nvar supportsKeyObjects = typeof crypto.createPublicKey === 'function';\nif (supportsKeyObjects) {\n  MSG_INVALID_VERIFIER_KEY += ' or a KeyObject';\n  MSG_INVALID_SECRET += 'or a KeyObject';\n}\n\nfunction checkIsPublicKey(key) {\n  if (Buffer.isBuffer(key)) {\n    return;\n  }\n\n  if (typeof key === 'string') {\n    return;\n  }\n\n  if (!supportsKeyObjects) {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key !== 'object') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key.type !== 'string') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key.asymmetricKeyType !== 'string') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n\n  if (typeof key.export !== 'function') {\n    throw typeError(MSG_INVALID_VERIFIER_KEY);\n  }\n};\n\nfunction checkIsPrivateKey(key) {\n  if (Buffer.isBuffer(key)) {\n    return;\n  }\n\n  if (typeof key === 'string') {\n    return;\n  }\n\n  if (typeof key === 'object') {\n    return;\n  }\n\n  throw typeError(MSG_INVALID_SIGNER_KEY);\n};\n\nfunction checkIsSecretKey(key) {\n  if (Buffer.isBuffer(key)) {\n    return;\n  }\n\n  if (typeof key === 'string') {\n    return key;\n  }\n\n  if (!supportsKeyObjects) {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n\n  if (typeof key !== 'object') {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n\n  if (key.type !== 'secret') {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n\n  if (typeof key.export !== 'function') {\n    throw typeError(MSG_INVALID_SECRET);\n  }\n}\n\nfunction fromBase64(base64) {\n  return base64\n    .replace(/=/g, '')\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_');\n}\n\nfunction toBase64(base64url) {\n  base64url = base64url.toString();\n\n  var padding = 4 - base64url.length % 4;\n  if (padding !== 4) {\n    for (var i = 0; i < padding; ++i) {\n      base64url += '=';\n    }\n  }\n\n  return base64url\n    .replace(/\\-/g, '+')\n    .replace(/_/g, '/');\n}\n\nfunction typeError(template) {\n  var args = [].slice.call(arguments, 1);\n  var errMsg = util.format.bind(util, template).apply(null, args);\n  return new TypeError(errMsg);\n}\n\nfunction bufferOrString(obj) {\n  return Buffer.isBuffer(obj) || typeof obj === 'string';\n}\n\nfunction normalizeInput(thing) {\n  if (!bufferOrString(thing))\n    thing = JSON.stringify(thing);\n  return thing;\n}\n\nfunction createHmacSigner(bits) {\n  return function sign(thing, secret) {\n    checkIsSecretKey(secret);\n    thing = normalizeInput(thing);\n    var hmac = crypto.createHmac('sha' + bits, secret);\n    var sig = (hmac.update(thing), hmac.digest('base64'))\n    return fromBase64(sig);\n  }\n}\n\nfunction createHmacVerifier(bits) {\n  return function verify(thing, signature, secret) {\n    var computedSig = createHmacSigner(bits)(thing, secret);\n    return bufferEqual(Buffer.from(signature), Buffer.from(computedSig));\n  }\n}\n\nfunction createKeySigner(bits) {\n return function sign(thing, privateKey) {\n    checkIsPrivateKey(privateKey);\n    thing = normalizeInput(thing);\n    // Even though we are specifying \"RSA\" here, this works with ECDSA\n    // keys as well.\n    var signer = crypto.createSign('RSA-SHA' + bits);\n    var sig = (signer.update(thing), signer.sign(privateKey, 'base64'));\n    return fromBase64(sig);\n  }\n}\n\nfunction createKeyVerifier(bits) {\n  return function verify(thing, signature, publicKey) {\n    checkIsPublicKey(publicKey);\n    thing = normalizeInput(thing);\n    signature = toBase64(signature);\n    var verifier = crypto.createVerify('RSA-SHA' + bits);\n    verifier.update(thing);\n    return verifier.verify(publicKey, signature, 'base64');\n  }\n}\n\nfunction createPSSKeySigner(bits) {\n  return function sign(thing, privateKey) {\n    checkIsPrivateKey(privateKey);\n    thing = normalizeInput(thing);\n    var signer = crypto.createSign('RSA-SHA' + bits);\n    var sig = (signer.update(thing), signer.sign({\n      key: privateKey,\n      padding: crypto.constants.RSA_PKCS1_PSS_PADDING,\n      saltLength: crypto.constants.RSA_PSS_SALTLEN_DIGEST\n    }, 'base64'));\n    return fromBase64(sig);\n  }\n}\n\nfunction createPSSKeyVerifier(bits) {\n  return function verify(thing, signature, publicKey) {\n    checkIsPublicKey(publicKey);\n    thing = normalizeInput(thing);\n    signature = toBase64(signature);\n    var verifier = crypto.createVerify('RSA-SHA' + bits);\n    verifier.update(thing);\n    return verifier.verify({\n      key: publicKey,\n      padding: crypto.constants.RSA_PKCS1_PSS_PADDING,\n      saltLength: crypto.constants.RSA_PSS_SALTLEN_DIGEST\n    }, signature, 'base64');\n  }\n}\n\nfunction createECDSASigner(bits) {\n  var inner = createKeySigner(bits);\n  return function sign() {\n    var signature = inner.apply(null, arguments);\n    signature = formatEcdsa.derToJose(signature, 'ES' + bits);\n    return signature;\n  };\n}\n\nfunction createECDSAVerifer(bits) {\n  var inner = createKeyVerifier(bits);\n  return function verify(thing, signature, publicKey) {\n    signature = formatEcdsa.joseToDer(signature, 'ES' + bits).toString('base64');\n    var result = inner(thing, signature, publicKey);\n    return result;\n  };\n}\n\nfunction createNoneSigner() {\n  return function sign() {\n    return '';\n  }\n}\n\nfunction createNoneVerifier() {\n  return function verify(thing, signature) {\n    return signature === '';\n  }\n}\n\nmodule.exports = function jwa(algorithm) {\n  var signerFactories = {\n    hs: createHmacSigner,\n    rs: createKeySigner,\n    ps: createPSSKeySigner,\n    es: createECDSASigner,\n    none: createNoneSigner,\n  }\n  var verifierFactories = {\n    hs: createHmacVerifier,\n    rs: createKeyVerifier,\n    ps: createPSSKeyVerifier,\n    es: createECDSAVerifer,\n    none: createNoneVerifier,\n  }\n  var match = algorithm.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);\n  if (!match)\n    throw typeError(MSG_INVALID_ALGORITHM, algorithm);\n  var algo = (match[1] || match[3]).toLowerCase();\n  var bits = match[2];\n\n  return {\n    sign: signerFactories[algo](bits),\n    verify: verifierFactories[algo](bits),\n  }\n};\n","/*global module*/\nvar Buffer = require('buffer').Buffer;\n\nmodule.exports = function toString(obj) {\n  if (typeof obj === 'string')\n    return obj;\n  if (typeof obj === 'number' || Buffer.isBuffer(obj))\n    return obj.toString();\n  return JSON.stringify(obj);\n};\n","/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\n\nfunction base64url(string, encoding) {\n  return Buffer\n    .from(string, encoding)\n    .toString('base64')\n    .replace(/=/g, '')\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_');\n}\n\nfunction jwsSecuredInput(header, payload, encoding) {\n  encoding = encoding || 'utf8';\n  var encodedHeader = base64url(toString(header), 'binary');\n  var encodedPayload = base64url(toString(payload), encoding);\n  return util.format('%s.%s', encodedHeader, encodedPayload);\n}\n\nfunction jwsSign(opts) {\n  var header = opts.header;\n  var payload = opts.payload;\n  var secretOrKey = opts.secret || opts.privateKey;\n  var encoding = opts.encoding;\n  var algo = jwa(header.alg);\n  var securedInput = jwsSecuredInput(header, payload, encoding);\n  var signature = algo.sign(securedInput, secretOrKey);\n  return util.format('%s.%s', securedInput, signature);\n}\n\nfunction SignStream(opts) {\n  var secret = opts.secret||opts.privateKey||opts.key;\n  var secretStream = new DataStream(secret);\n  this.readable = true;\n  this.header = opts.header;\n  this.encoding = opts.encoding;\n  this.secret = this.privateKey = this.key = secretStream;\n  this.payload = new DataStream(opts.payload);\n  this.secret.once('close', function () {\n    if (!this.payload.writable && this.readable)\n      this.sign();\n  }.bind(this));\n\n  this.payload.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.sign();\n  }.bind(this));\n}\nutil.inherits(SignStream, Stream);\n\nSignStream.prototype.sign = function sign() {\n  try {\n    var signature = jwsSign({\n      header: this.header,\n      payload: this.payload.buffer,\n      secret: this.secret.buffer,\n      encoding: this.encoding\n    });\n    this.emit('done', signature);\n    this.emit('data', signature);\n    this.emit('end');\n    this.readable = false;\n    return signature;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nSignStream.sign = jwsSign;\n\nmodule.exports = SignStream;\n","/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\nfunction isObject(thing) {\n  return Object.prototype.toString.call(thing) === '[object Object]';\n}\n\nfunction safeJsonParse(thing) {\n  if (isObject(thing))\n    return thing;\n  try { return JSON.parse(thing); }\n  catch (e) { return undefined; }\n}\n\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(Buffer.from(encodedHeader, 'base64').toString('binary'));\n}\n\nfunction securedInputFromJWS(jwsSig) {\n  return jwsSig.split('.', 2).join('.');\n}\n\nfunction signatureFromJWS(jwsSig) {\n  return jwsSig.split('.')[2];\n}\n\nfunction payloadFromJWS(jwsSig, encoding) {\n  encoding = encoding || 'utf8';\n  var payload = jwsSig.split('.')[1];\n  return Buffer.from(payload, 'base64').toString(encoding);\n}\n\nfunction isValidJws(string) {\n  return JWS_REGEX.test(string) && !!headerFromJWS(string);\n}\n\nfunction jwsVerify(jwsSig, algorithm, secretOrKey) {\n  if (!algorithm) {\n    var err = new Error(\"Missing algorithm parameter for jws.verify\");\n    err.code = \"MISSING_ALGORITHM\";\n    throw err;\n  }\n  jwsSig = toString(jwsSig);\n  var signature = signatureFromJWS(jwsSig);\n  var securedInput = securedInputFromJWS(jwsSig);\n  var algo = jwa(algorithm);\n  return algo.verify(securedInput, signature, secretOrKey);\n}\n\nfunction jwsDecode(jwsSig, opts) {\n  opts = opts || {};\n  jwsSig = toString(jwsSig);\n\n  if (!isValidJws(jwsSig))\n    return null;\n\n  var header = headerFromJWS(jwsSig);\n\n  if (!header)\n    return null;\n\n  var payload = payloadFromJWS(jwsSig);\n  if (header.typ === 'JWT' || opts.json)\n    payload = JSON.parse(payload, opts.encoding);\n\n  return {\n    header: header,\n    payload: payload,\n    signature: signatureFromJWS(jwsSig)\n  };\n}\n\nfunction VerifyStream(opts) {\n  opts = opts || {};\n  var secretOrKey = opts.secret||opts.publicKey||opts.key;\n  var secretStream = new DataStream(secretOrKey);\n  this.readable = true;\n  this.algorithm = opts.algorithm;\n  this.encoding = opts.encoding;\n  this.secret = this.publicKey = this.key = secretStream;\n  this.signature = new DataStream(opts.signature);\n  this.secret.once('close', function () {\n    if (!this.signature.writable && this.readable)\n      this.verify();\n  }.bind(this));\n\n  this.signature.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.verify();\n  }.bind(this));\n}\nutil.inherits(VerifyStream, Stream);\nVerifyStream.prototype.verify = function verify() {\n  try {\n    var valid = jwsVerify(this.signature.buffer, this.algorithm, this.key.buffer);\n    var obj = jwsDecode(this.signature.buffer, this.encoding);\n    this.emit('done', valid, obj);\n    this.emit('data', valid);\n    this.emit('end');\n    this.readable = false;\n    return valid;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nVerifyStream.decode = jwsDecode;\nVerifyStream.isValid = isValidJws;\nVerifyStream.verify = jwsVerify;\n\nmodule.exports = VerifyStream;\n","/*global exports*/\nvar SignStream = require('./lib/sign-stream');\nvar VerifyStream = require('./lib/verify-stream');\n\nvar ALGORITHMS = [\n  'HS256', 'HS384', 'HS512',\n  'RS256', 'RS384', 'RS512',\n  'PS256', 'PS384', 'PS512',\n  'ES256', 'ES384', 'ES512'\n];\n\nexports.ALGORITHMS = ALGORITHMS;\nexports.sign = SignStream.sign;\nexports.verify = VerifyStream.verify;\nexports.decode = VerifyStream.decode;\nexports.isValid = VerifyStream.isValid;\nexports.createSign = function createSign(opts) {\n  return new SignStream(opts);\n};\nexports.createVerify = function createVerify(opts) {\n  return new VerifyStream(opts);\n};\n","var JsonWebTokenError = function (message, error) {\n  Error.call(this, message);\n  if(Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  }\n  this.name = 'JsonWebTokenError';\n  this.message = message;\n  if (error) this.inner = error;\n};\n\nJsonWebTokenError.prototype = Object.create(Error.prototype);\nJsonWebTokenError.prototype.constructor = JsonWebTokenError;\n\nmodule.exports = JsonWebTokenError;\n","var JsonWebTokenError = require('./JsonWebTokenError');\n\nvar NotBeforeError = function (message, date) {\n  JsonWebTokenError.call(this, message);\n  this.name = 'NotBeforeError';\n  this.date = date;\n};\n\nNotBeforeError.prototype = Object.create(JsonWebTokenError.prototype);\n\nNotBeforeError.prototype.constructor = NotBeforeError;\n\nmodule.exports = NotBeforeError;","var JsonWebTokenError = require('./JsonWebTokenError');\n\nvar TokenExpiredError = function (message, expiredAt) {\n  JsonWebTokenError.call(this, message);\n  this.name = 'TokenExpiredError';\n  this.expiredAt = expiredAt;\n};\n\nTokenExpiredError.prototype = Object.create(JsonWebTokenError.prototype);\n\nTokenExpiredError.prototype.constructor = TokenExpiredError;\n\nmodule.exports = TokenExpiredError;","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function (val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","var ms = require('ms');\n\nmodule.exports = function (time, iat) {\n  var timestamp = iat || Math.floor(Date.now() / 1000);\n\n  if (typeof time === 'string') {\n    var milliseconds = ms(time);\n    if (typeof milliseconds === 'undefined') {\n      return;\n    }\n    return Math.floor(timestamp + milliseconds / 1000);\n  } else if (typeof time === 'number') {\n    return timestamp + time;\n  } else {\n    return;\n  }\n\n};","// Note: this is the semver.org version of the spec that it implements\n// Not necessarily the package version of this code.\nconst SEMVER_SPEC_VERSION = '2.0.0'\n\nconst MAX_LENGTH = 256\nconst MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER ||\n/* istanbul ignore next */ 9007199254740991\n\n// Max safe segment length for coercion.\nconst MAX_SAFE_COMPONENT_LENGTH = 16\n\n// Max safe length for a build identifier. The max length minus 6 characters for\n// the shortest version with a build 0.0.0+BUILD.\nconst MAX_SAFE_BUILD_LENGTH = MAX_LENGTH - 6\n\nconst RELEASE_TYPES = [\n  'major',\n  'premajor',\n  'minor',\n  'preminor',\n  'patch',\n  'prepatch',\n  'prerelease',\n]\n\nmodule.exports = {\n  MAX_LENGTH,\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_SAFE_INTEGER,\n  RELEASE_TYPES,\n  SEMVER_SPEC_VERSION,\n  FLAG_INCLUDE_PRERELEASE: 0b001,\n  FLAG_LOOSE: 0b010,\n}\n","const debug = (\n  typeof process === 'object' &&\n  process.env &&\n  process.env.NODE_DEBUG &&\n  /\\bsemver\\b/i.test(process.env.NODE_DEBUG)\n) ? (...args) => console.error('SEMVER', ...args)\n  : () => {}\n\nmodule.exports = debug\n","const {\n  MAX_SAFE_COMPONENT_LENGTH,\n  MAX_SAFE_BUILD_LENGTH,\n  MAX_LENGTH,\n} = require('./constants')\nconst debug = require('./debug')\nexports = module.exports = {}\n\n// The actual regexps go on exports.re\nconst re = exports.re = []\nconst safeRe = exports.safeRe = []\nconst src = exports.src = []\nconst t = exports.t = {}\nlet R = 0\n\nconst LETTERDASHNUMBER = '[a-zA-Z0-9-]'\n\n// Replace some greedy regex tokens to prevent regex dos issues. These regex are\n// used internally via the safeRe object since all inputs in this library get\n// normalized first to trim and collapse all extra whitespace. The original\n// regexes are exported for userland consumption and lower level usage. A\n// future breaking change could export the safer regex only with a note that\n// all input should have extra whitespace removed.\nconst safeRegexReplacements = [\n  ['\\\\s', 1],\n  ['\\\\d', MAX_LENGTH],\n  [LETTERDASHNUMBER, MAX_SAFE_BUILD_LENGTH],\n]\n\nconst makeSafeRegex = (value) => {\n  for (const [token, max] of safeRegexReplacements) {\n    value = value\n      .split(`${token}*`).join(`${token}{0,${max}}`)\n      .split(`${token}+`).join(`${token}{1,${max}}`)\n  }\n  return value\n}\n\nconst createToken = (name, value, isGlobal) => {\n  const safe = makeSafeRegex(value)\n  const index = R++\n  debug(name, index, value)\n  t[name] = index\n  src[index] = value\n  re[index] = new RegExp(value, isGlobal ? 'g' : undefined)\n  safeRe[index] = new RegExp(safe, isGlobal ? 'g' : undefined)\n}\n\n// The following Regular Expressions can be used for tokenizing,\n// validating, and parsing SemVer version strings.\n\n// ## Numeric Identifier\n// A single `0`, or a non-zero digit followed by zero or more digits.\n\ncreateToken('NUMERICIDENTIFIER', '0|[1-9]\\\\d*')\ncreateToken('NUMERICIDENTIFIERLOOSE', '\\\\d+')\n\n// ## Non-numeric Identifier\n// Zero or more digits, followed by a letter or hyphen, and then zero or\n// more letters, digits, or hyphens.\n\ncreateToken('NONNUMERICIDENTIFIER', `\\\\d*[a-zA-Z-]${LETTERDASHNUMBER}*`)\n\n// ## Main Version\n// Three dot-separated numeric identifiers.\n\ncreateToken('MAINVERSION', `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})\\\\.` +\n                   `(${src[t.NUMERICIDENTIFIER]})`)\n\ncreateToken('MAINVERSIONLOOSE', `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})\\\\.` +\n                        `(${src[t.NUMERICIDENTIFIERLOOSE]})`)\n\n// ## Pre-release Version Identifier\n// A numeric identifier, or a non-numeric identifier.\n\ncreateToken('PRERELEASEIDENTIFIER', `(?:${src[t.NUMERICIDENTIFIER]\n}|${src[t.NONNUMERICIDENTIFIER]})`)\n\ncreateToken('PRERELEASEIDENTIFIERLOOSE', `(?:${src[t.NUMERICIDENTIFIERLOOSE]\n}|${src[t.NONNUMERICIDENTIFIER]})`)\n\n// ## Pre-release Version\n// Hyphen, followed by one or more dot-separated pre-release version\n// identifiers.\n\ncreateToken('PRERELEASE', `(?:-(${src[t.PRERELEASEIDENTIFIER]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIER]})*))`)\n\ncreateToken('PRERELEASELOOSE', `(?:-?(${src[t.PRERELEASEIDENTIFIERLOOSE]\n}(?:\\\\.${src[t.PRERELEASEIDENTIFIERLOOSE]})*))`)\n\n// ## Build Metadata Identifier\n// Any combination of digits, letters, or hyphens.\n\ncreateToken('BUILDIDENTIFIER', `${LETTERDASHNUMBER}+`)\n\n// ## Build Metadata\n// Plus sign, followed by one or more period-separated build metadata\n// identifiers.\n\ncreateToken('BUILD', `(?:\\\\+(${src[t.BUILDIDENTIFIER]\n}(?:\\\\.${src[t.BUILDIDENTIFIER]})*))`)\n\n// ## Full Version String\n// A main version, followed optionally by a pre-release version and\n// build metadata.\n\n// Note that the only major, minor, patch, and pre-release sections of\n// the version string are capturing groups.  The build metadata is not a\n// capturing group, because it should not ever be used in version\n// comparison.\n\ncreateToken('FULLPLAIN', `v?${src[t.MAINVERSION]\n}${src[t.PRERELEASE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('FULL', `^${src[t.FULLPLAIN]}$`)\n\n// like full, but allows v1.2.3 and =1.2.3, which people do sometimes.\n// also, 1.0.0alpha1 (prerelease without the hyphen) which is pretty\n// common in the npm registry.\ncreateToken('LOOSEPLAIN', `[v=\\\\s]*${src[t.MAINVERSIONLOOSE]\n}${src[t.PRERELEASELOOSE]}?${\n  src[t.BUILD]}?`)\n\ncreateToken('LOOSE', `^${src[t.LOOSEPLAIN]}$`)\n\ncreateToken('GTLT', '((?:<|>)?=?)')\n\n// Something like \"2.*\" or \"1.2.x\".\n// Note that \"x.x\" is a valid xRange identifer, meaning \"any version\"\n// Only the first item is strictly required.\ncreateToken('XRANGEIDENTIFIERLOOSE', `${src[t.NUMERICIDENTIFIERLOOSE]}|x|X|\\\\*`)\ncreateToken('XRANGEIDENTIFIER', `${src[t.NUMERICIDENTIFIER]}|x|X|\\\\*`)\n\ncreateToken('XRANGEPLAIN', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:\\\\.(${src[t.XRANGEIDENTIFIER]})` +\n                   `(?:${src[t.PRERELEASE]})?${\n                     src[t.BUILD]}?` +\n                   `)?)?`)\n\ncreateToken('XRANGEPLAINLOOSE', `[v=\\\\s]*(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:\\\\.(${src[t.XRANGEIDENTIFIERLOOSE]})` +\n                        `(?:${src[t.PRERELEASELOOSE]})?${\n                          src[t.BUILD]}?` +\n                        `)?)?`)\n\ncreateToken('XRANGE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAIN]}$`)\ncreateToken('XRANGELOOSE', `^${src[t.GTLT]}\\\\s*${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Coercion.\n// Extract anything that could conceivably be a part of a valid semver\ncreateToken('COERCE', `${'(^|[^\\\\d])' +\n              '(\\\\d{1,'}${MAX_SAFE_COMPONENT_LENGTH}})` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?` +\n              `(?:\\\\.(\\\\d{1,${MAX_SAFE_COMPONENT_LENGTH}}))?` +\n              `(?:$|[^\\\\d])`)\ncreateToken('COERCERTL', src[t.COERCE], true)\n\n// Tilde ranges.\n// Meaning is \"reasonably at or greater than\"\ncreateToken('LONETILDE', '(?:~>?)')\n\ncreateToken('TILDETRIM', `(\\\\s*)${src[t.LONETILDE]}\\\\s+`, true)\nexports.tildeTrimReplace = '$1~'\n\ncreateToken('TILDE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('TILDELOOSE', `^${src[t.LONETILDE]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// Caret ranges.\n// Meaning is \"at least and backwards compatible with\"\ncreateToken('LONECARET', '(?:\\\\^)')\n\ncreateToken('CARETTRIM', `(\\\\s*)${src[t.LONECARET]}\\\\s+`, true)\nexports.caretTrimReplace = '$1^'\n\ncreateToken('CARET', `^${src[t.LONECARET]}${src[t.XRANGEPLAIN]}$`)\ncreateToken('CARETLOOSE', `^${src[t.LONECARET]}${src[t.XRANGEPLAINLOOSE]}$`)\n\n// A simple gt/lt/eq thing, or just \"\" to indicate \"any version\"\ncreateToken('COMPARATORLOOSE', `^${src[t.GTLT]}\\\\s*(${src[t.LOOSEPLAIN]})$|^$`)\ncreateToken('COMPARATOR', `^${src[t.GTLT]}\\\\s*(${src[t.FULLPLAIN]})$|^$`)\n\n// An expression to strip any whitespace between the gtlt and the thing\n// it modifies, so that `> 1.2.3` ==> `>1.2.3`\ncreateToken('COMPARATORTRIM', `(\\\\s*)${src[t.GTLT]\n}\\\\s*(${src[t.LOOSEPLAIN]}|${src[t.XRANGEPLAIN]})`, true)\nexports.comparatorTrimReplace = '$1$2$3'\n\n// Something like `1.2.3 - 1.2.4`\n// Note that these all use the loose form, because they'll be\n// checked against either the strict or loose comparator form\n// later.\ncreateToken('HYPHENRANGE', `^\\\\s*(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s+-\\\\s+` +\n                   `(${src[t.XRANGEPLAIN]})` +\n                   `\\\\s*$`)\n\ncreateToken('HYPHENRANGELOOSE', `^\\\\s*(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s+-\\\\s+` +\n                        `(${src[t.XRANGEPLAINLOOSE]})` +\n                        `\\\\s*$`)\n\n// Star ranges basically just allow anything at all.\ncreateToken('STAR', '(<|>)?=?\\\\s*\\\\*')\n// >=0.0.0 is like a star\ncreateToken('GTE0', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0\\\\s*$')\ncreateToken('GTE0PRE', '^\\\\s*>=\\\\s*0\\\\.0\\\\.0-0\\\\s*$')\n","// parse out just the options we care about\nconst looseOption = Object.freeze({ loose: true })\nconst emptyOpts = Object.freeze({ })\nconst parseOptions = options => {\n  if (!options) {\n    return emptyOpts\n  }\n\n  if (typeof options !== 'object') {\n    return looseOption\n  }\n\n  return options\n}\nmodule.exports = parseOptions\n","const numeric = /^[0-9]+$/\nconst compareIdentifiers = (a, b) => {\n  const anum = numeric.test(a)\n  const bnum = numeric.test(b)\n\n  if (anum && bnum) {\n    a = +a\n    b = +b\n  }\n\n  return a === b ? 0\n    : (anum && !bnum) ? -1\n    : (bnum && !anum) ? 1\n    : a < b ? -1\n    : 1\n}\n\nconst rcompareIdentifiers = (a, b) => compareIdentifiers(b, a)\n\nmodule.exports = {\n  compareIdentifiers,\n  rcompareIdentifiers,\n}\n","const debug = require('../internal/debug')\nconst { MAX_LENGTH, MAX_SAFE_INTEGER } = require('../internal/constants')\nconst { safeRe: re, t } = require('../internal/re')\n\nconst parseOptions = require('../internal/parse-options')\nconst { compareIdentifiers } = require('../internal/identifiers')\nclass SemVer {\n  constructor (version, options) {\n    options = parseOptions(options)\n\n    if (version instanceof SemVer) {\n      if (version.loose === !!options.loose &&\n          version.includePrerelease === !!options.includePrerelease) {\n        return version\n      } else {\n        version = version.version\n      }\n    } else if (typeof version !== 'string') {\n      throw new TypeError(`Invalid version. Must be a string. Got type \"${typeof version}\".`)\n    }\n\n    if (version.length > MAX_LENGTH) {\n      throw new TypeError(\n        `version is longer than ${MAX_LENGTH} characters`\n      )\n    }\n\n    debug('SemVer', version, options)\n    this.options = options\n    this.loose = !!options.loose\n    // this isn't actually relevant for versions, but keep it so that we\n    // don't run into trouble passing this.options around.\n    this.includePrerelease = !!options.includePrerelease\n\n    const m = version.trim().match(options.loose ? re[t.LOOSE] : re[t.FULL])\n\n    if (!m) {\n      throw new TypeError(`Invalid Version: ${version}`)\n    }\n\n    this.raw = version\n\n    // these are actually numbers\n    this.major = +m[1]\n    this.minor = +m[2]\n    this.patch = +m[3]\n\n    if (this.major > MAX_SAFE_INTEGER || this.major < 0) {\n      throw new TypeError('Invalid major version')\n    }\n\n    if (this.minor > MAX_SAFE_INTEGER || this.minor < 0) {\n      throw new TypeError('Invalid minor version')\n    }\n\n    if (this.patch > MAX_SAFE_INTEGER || this.patch < 0) {\n      throw new TypeError('Invalid patch version')\n    }\n\n    // numberify any prerelease numeric ids\n    if (!m[4]) {\n      this.prerelease = []\n    } else {\n      this.prerelease = m[4].split('.').map((id) => {\n        if (/^[0-9]+$/.test(id)) {\n          const num = +id\n          if (num >= 0 && num < MAX_SAFE_INTEGER) {\n            return num\n          }\n        }\n        return id\n      })\n    }\n\n    this.build = m[5] ? m[5].split('.') : []\n    this.format()\n  }\n\n  format () {\n    this.version = `${this.major}.${this.minor}.${this.patch}`\n    if (this.prerelease.length) {\n      this.version += `-${this.prerelease.join('.')}`\n    }\n    return this.version\n  }\n\n  toString () {\n    return this.version\n  }\n\n  compare (other) {\n    debug('SemVer.compare', this.version, this.options, other)\n    if (!(other instanceof SemVer)) {\n      if (typeof other === 'string' && other === this.version) {\n        return 0\n      }\n      other = new SemVer(other, this.options)\n    }\n\n    if (other.version === this.version) {\n      return 0\n    }\n\n    return this.compareMain(other) || this.comparePre(other)\n  }\n\n  compareMain (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    return (\n      compareIdentifiers(this.major, other.major) ||\n      compareIdentifiers(this.minor, other.minor) ||\n      compareIdentifiers(this.patch, other.patch)\n    )\n  }\n\n  comparePre (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    // NOT having a prerelease is > having one\n    if (this.prerelease.length && !other.prerelease.length) {\n      return -1\n    } else if (!this.prerelease.length && other.prerelease.length) {\n      return 1\n    } else if (!this.prerelease.length && !other.prerelease.length) {\n      return 0\n    }\n\n    let i = 0\n    do {\n      const a = this.prerelease[i]\n      const b = other.prerelease[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  compareBuild (other) {\n    if (!(other instanceof SemVer)) {\n      other = new SemVer(other, this.options)\n    }\n\n    let i = 0\n    do {\n      const a = this.build[i]\n      const b = other.build[i]\n      debug('prerelease compare', i, a, b)\n      if (a === undefined && b === undefined) {\n        return 0\n      } else if (b === undefined) {\n        return 1\n      } else if (a === undefined) {\n        return -1\n      } else if (a === b) {\n        continue\n      } else {\n        return compareIdentifiers(a, b)\n      }\n    } while (++i)\n  }\n\n  // preminor will bump the version up to the next minor release, and immediately\n  // down to pre-release. premajor and prepatch work the same way.\n  inc (release, identifier, identifierBase) {\n    switch (release) {\n      case 'premajor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor = 0\n        this.major++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'preminor':\n        this.prerelease.length = 0\n        this.patch = 0\n        this.minor++\n        this.inc('pre', identifier, identifierBase)\n        break\n      case 'prepatch':\n        // If this is already a prerelease, it will bump to the next version\n        // drop any prereleases that might already exist, since they are not\n        // relevant at this point.\n        this.prerelease.length = 0\n        this.inc('patch', identifier, identifierBase)\n        this.inc('pre', identifier, identifierBase)\n        break\n      // If the input is a non-prerelease version, this acts the same as\n      // prepatch.\n      case 'prerelease':\n        if (this.prerelease.length === 0) {\n          this.inc('patch', identifier, identifierBase)\n        }\n        this.inc('pre', identifier, identifierBase)\n        break\n\n      case 'major':\n        // If this is a pre-major version, bump up to the same major version.\n        // Otherwise increment major.\n        // 1.0.0-5 bumps to 1.0.0\n        // 1.1.0 bumps to 2.0.0\n        if (\n          this.minor !== 0 ||\n          this.patch !== 0 ||\n          this.prerelease.length === 0\n        ) {\n          this.major++\n        }\n        this.minor = 0\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'minor':\n        // If this is a pre-minor version, bump up to the same minor version.\n        // Otherwise increment minor.\n        // 1.2.0-5 bumps to 1.2.0\n        // 1.2.1 bumps to 1.3.0\n        if (this.patch !== 0 || this.prerelease.length === 0) {\n          this.minor++\n        }\n        this.patch = 0\n        this.prerelease = []\n        break\n      case 'patch':\n        // If this is not a pre-release version, it will increment the patch.\n        // If it is a pre-release it will bump up to the same patch version.\n        // 1.2.0-5 patches to 1.2.0\n        // 1.2.0 patches to 1.2.1\n        if (this.prerelease.length === 0) {\n          this.patch++\n        }\n        this.prerelease = []\n        break\n      // This probably shouldn't be used publicly.\n      // 1.0.0 'pre' would become 1.0.0-0 which is the wrong direction.\n      case 'pre': {\n        const base = Number(identifierBase) ? 1 : 0\n\n        if (!identifier && identifierBase === false) {\n          throw new Error('invalid increment argument: identifier is empty')\n        }\n\n        if (this.prerelease.length === 0) {\n          this.prerelease = [base]\n        } else {\n          let i = this.prerelease.length\n          while (--i >= 0) {\n            if (typeof this.prerelease[i] === 'number') {\n              this.prerelease[i]++\n              i = -2\n            }\n          }\n          if (i === -1) {\n            // didn't increment anything\n            if (identifier === this.prerelease.join('.') && identifierBase === false) {\n              throw new Error('invalid increment argument: identifier already exists')\n            }\n            this.prerelease.push(base)\n          }\n        }\n        if (identifier) {\n          // 1.2.0-beta.1 bumps to 1.2.0-beta.2,\n          // 1.2.0-beta.fooblz or 1.2.0-beta bumps to 1.2.0-beta.0\n          let prerelease = [identifier, base]\n          if (identifierBase === false) {\n            prerelease = [identifier]\n          }\n          if (compareIdentifiers(this.prerelease[0], identifier) === 0) {\n            if (isNaN(this.prerelease[1])) {\n              this.prerelease = prerelease\n            }\n          } else {\n            this.prerelease = prerelease\n          }\n        }\n        break\n      }\n      default:\n        throw new Error(`invalid increment argument: ${release}`)\n    }\n    this.raw = this.format()\n    if (this.build.length) {\n      this.raw += `+${this.build.join('.')}`\n    }\n    return this\n  }\n}\n\nmodule.exports = SemVer\n","const SemVer = require('../classes/semver')\nconst compare = (a, b, loose) =>\n  new SemVer(a, loose).compare(new SemVer(b, loose))\n\nmodule.exports = compare\n","const eq = require('./eq')\nconst neq = require('./neq')\nconst gt = require('./gt')\nconst gte = require('./gte')\nconst lt = require('./lt')\nconst lte = require('./lte')\n\nconst cmp = (a, op, b, loose) => {\n  switch (op) {\n    case '===':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a === b\n\n    case '!==':\n      if (typeof a === 'object') {\n        a = a.version\n      }\n      if (typeof b === 'object') {\n        b = b.version\n      }\n      return a !== b\n\n    case '':\n    case '=':\n    case '==':\n      return eq(a, b, loose)\n\n    case '!=':\n      return neq(a, b, loose)\n\n    case '>':\n      return gt(a, b, loose)\n\n    case '>=':\n      return gte(a, b, loose)\n\n    case '<':\n      return lt(a, b, loose)\n\n    case '<=':\n      return lte(a, b, loose)\n\n    default:\n      throw new TypeError(`Invalid operator: ${op}`)\n  }\n}\nmodule.exports = cmp\n","const compare = require('./compare')\nconst eq = (a, b, loose) => compare(a, b, loose) === 0\nmodule.exports = eq\n","const compare = require('./compare')\nconst neq = (a, b, loose) => compare(a, b, loose) !== 0\nmodule.exports = neq\n","const compare = require('./compare')\nconst gt = (a, b, loose) => compare(a, b, loose) > 0\nmodule.exports = gt\n","const compare = require('./compare')\nconst gte = (a, b, loose) => compare(a, b, loose) >= 0\nmodule.exports = gte\n","const compare = require('./compare')\nconst lt = (a, b, loose) => compare(a, b, loose) < 0\nmodule.exports = lt\n","const compare = require('./compare')\nconst lte = (a, b, loose) => compare(a, b, loose) <= 0\nmodule.exports = lte\n","'use strict'\nmodule.exports = Yallist\n\nYallist.Node = Node\nYallist.create = Yallist\n\nfunction Yallist (list) {\n  var self = this\n  if (!(self instanceof Yallist)) {\n    self = new Yallist()\n  }\n\n  self.tail = null\n  self.head = null\n  self.length = 0\n\n  if (list && typeof list.forEach === 'function') {\n    list.forEach(function (item) {\n      self.push(item)\n    })\n  } else if (arguments.length > 0) {\n    for (var i = 0, l = arguments.length; i < l; i++) {\n      self.push(arguments[i])\n    }\n  }\n\n  return self\n}\n\nYallist.prototype.removeNode = function (node) {\n  if (node.list !== this) {\n    throw new Error('removing node which does not belong to this list')\n  }\n\n  var next = node.next\n  var prev = node.prev\n\n  if (next) {\n    next.prev = prev\n  }\n\n  if (prev) {\n    prev.next = next\n  }\n\n  if (node === this.head) {\n    this.head = next\n  }\n  if (node === this.tail) {\n    this.tail = prev\n  }\n\n  node.list.length--\n  node.next = null\n  node.prev = null\n  node.list = null\n\n  return next\n}\n\nYallist.prototype.unshiftNode = function (node) {\n  if (node === this.head) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var head = this.head\n  node.list = this\n  node.next = head\n  if (head) {\n    head.prev = node\n  }\n\n  this.head = node\n  if (!this.tail) {\n    this.tail = node\n  }\n  this.length++\n}\n\nYallist.prototype.pushNode = function (node) {\n  if (node === this.tail) {\n    return\n  }\n\n  if (node.list) {\n    node.list.removeNode(node)\n  }\n\n  var tail = this.tail\n  node.list = this\n  node.prev = tail\n  if (tail) {\n    tail.next = node\n  }\n\n  this.tail = node\n  if (!this.head) {\n    this.head = node\n  }\n  this.length++\n}\n\nYallist.prototype.push = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    push(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.unshift = function () {\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    unshift(this, arguments[i])\n  }\n  return this.length\n}\n\nYallist.prototype.pop = function () {\n  if (!this.tail) {\n    return undefined\n  }\n\n  var res = this.tail.value\n  this.tail = this.tail.prev\n  if (this.tail) {\n    this.tail.next = null\n  } else {\n    this.head = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.shift = function () {\n  if (!this.head) {\n    return undefined\n  }\n\n  var res = this.head.value\n  this.head = this.head.next\n  if (this.head) {\n    this.head.prev = null\n  } else {\n    this.tail = null\n  }\n  this.length--\n  return res\n}\n\nYallist.prototype.forEach = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.head, i = 0; walker !== null; i++) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.next\n  }\n}\n\nYallist.prototype.forEachReverse = function (fn, thisp) {\n  thisp = thisp || this\n  for (var walker = this.tail, i = this.length - 1; walker !== null; i--) {\n    fn.call(thisp, walker.value, i, this)\n    walker = walker.prev\n  }\n}\n\nYallist.prototype.get = function (n) {\n  for (var i = 0, walker = this.head; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.next\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.getReverse = function (n) {\n  for (var i = 0, walker = this.tail; walker !== null && i < n; i++) {\n    // abort out of the list early if we hit a cycle\n    walker = walker.prev\n  }\n  if (i === n && walker !== null) {\n    return walker.value\n  }\n}\n\nYallist.prototype.map = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.head; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.next\n  }\n  return res\n}\n\nYallist.prototype.mapReverse = function (fn, thisp) {\n  thisp = thisp || this\n  var res = new Yallist()\n  for (var walker = this.tail; walker !== null;) {\n    res.push(fn.call(thisp, walker.value, this))\n    walker = walker.prev\n  }\n  return res\n}\n\nYallist.prototype.reduce = function (fn, initial) {\n  var acc\n  var walker = this.head\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.head) {\n    walker = this.head.next\n    acc = this.head.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = 0; walker !== null; i++) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.next\n  }\n\n  return acc\n}\n\nYallist.prototype.reduceReverse = function (fn, initial) {\n  var acc\n  var walker = this.tail\n  if (arguments.length > 1) {\n    acc = initial\n  } else if (this.tail) {\n    walker = this.tail.prev\n    acc = this.tail.value\n  } else {\n    throw new TypeError('Reduce of empty list with no initial value')\n  }\n\n  for (var i = this.length - 1; walker !== null; i--) {\n    acc = fn(acc, walker.value, i)\n    walker = walker.prev\n  }\n\n  return acc\n}\n\nYallist.prototype.toArray = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.head; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.next\n  }\n  return arr\n}\n\nYallist.prototype.toArrayReverse = function () {\n  var arr = new Array(this.length)\n  for (var i = 0, walker = this.tail; walker !== null; i++) {\n    arr[i] = walker.value\n    walker = walker.prev\n  }\n  return arr\n}\n\nYallist.prototype.slice = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = 0, walker = this.head; walker !== null && i < from; i++) {\n    walker = walker.next\n  }\n  for (; walker !== null && i < to; i++, walker = walker.next) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.sliceReverse = function (from, to) {\n  to = to || this.length\n  if (to < 0) {\n    to += this.length\n  }\n  from = from || 0\n  if (from < 0) {\n    from += this.length\n  }\n  var ret = new Yallist()\n  if (to < from || to < 0) {\n    return ret\n  }\n  if (from < 0) {\n    from = 0\n  }\n  if (to > this.length) {\n    to = this.length\n  }\n  for (var i = this.length, walker = this.tail; walker !== null && i > to; i--) {\n    walker = walker.prev\n  }\n  for (; walker !== null && i > from; i--, walker = walker.prev) {\n    ret.push(walker.value)\n  }\n  return ret\n}\n\nYallist.prototype.splice = function (start, deleteCount, ...nodes) {\n  if (start > this.length) {\n    start = this.length - 1\n  }\n  if (start < 0) {\n    start = this.length + start;\n  }\n\n  for (var i = 0, walker = this.head; walker !== null && i < start; i++) {\n    walker = walker.next\n  }\n\n  var ret = []\n  for (var i = 0; walker && i < deleteCount; i++) {\n    ret.push(walker.value)\n    walker = this.removeNode(walker)\n  }\n  if (walker === null) {\n    walker = this.tail\n  }\n\n  if (walker !== this.head && walker !== this.tail) {\n    walker = walker.prev\n  }\n\n  for (var i = 0; i < nodes.length; i++) {\n    walker = insert(this, walker, nodes[i])\n  }\n  return ret;\n}\n\nYallist.prototype.reverse = function () {\n  var head = this.head\n  var tail = this.tail\n  for (var walker = head; walker !== null; walker = walker.prev) {\n    var p = walker.prev\n    walker.prev = walker.next\n    walker.next = p\n  }\n  this.head = tail\n  this.tail = head\n  return this\n}\n\nfunction insert (self, node, value) {\n  var inserted = node === self.head ?\n    new Node(value, null, node, self) :\n    new Node(value, node, node.next, self)\n\n  if (inserted.next === null) {\n    self.tail = inserted\n  }\n  if (inserted.prev === null) {\n    self.head = inserted\n  }\n\n  self.length++\n\n  return inserted\n}\n\nfunction push (self, item) {\n  self.tail = new Node(item, self.tail, null, self)\n  if (!self.head) {\n    self.head = self.tail\n  }\n  self.length++\n}\n\nfunction unshift (self, item) {\n  self.head = new Node(item, null, self.head, self)\n  if (!self.tail) {\n    self.tail = self.head\n  }\n  self.length++\n}\n\nfunction Node (value, prev, next, list) {\n  if (!(this instanceof Node)) {\n    return new Node(value, prev, next, list)\n  }\n\n  this.list = list\n  this.value = value\n\n  if (prev) {\n    prev.next = this\n    this.prev = prev\n  } else {\n    this.prev = null\n  }\n\n  if (next) {\n    next.prev = this\n    this.next = next\n  } else {\n    this.next = null\n  }\n}\n\ntry {\n  // add if support for Symbol.iterator is present\n  require('./iterator.js')(Yallist)\n} catch (er) {}\n","'use strict'\nmodule.exports = function (Yallist) {\n  Yallist.prototype[Symbol.iterator] = function* () {\n    for (let walker = this.head; walker; walker = walker.next) {\n      yield walker.value\n    }\n  }\n}\n","'use strict'\n\n// A linked list to keep track of recently-used-ness\nconst Yallist = require('yallist')\n\nconst MAX = Symbol('max')\nconst LENGTH = Symbol('length')\nconst LENGTH_CALCULATOR = Symbol('lengthCalculator')\nconst ALLOW_STALE = Symbol('allowStale')\nconst MAX_AGE = Symbol('maxAge')\nconst DISPOSE = Symbol('dispose')\nconst NO_DISPOSE_ON_SET = Symbol('noDisposeOnSet')\nconst LRU_LIST = Symbol('lruList')\nconst CACHE = Symbol('cache')\nconst UPDATE_AGE_ON_GET = Symbol('updateAgeOnGet')\n\nconst naiveLength = () => 1\n\n// lruList is a yallist where the head is the youngest\n// item, and the tail is the oldest.  the list contains the Hit\n// objects as the entries.\n// Each Hit object has a reference to its Yallist.Node.  This\n// never changes.\n//\n// cache is a Map (or PseudoMap) that matches the keys to\n// the Yallist.Node object.\nclass LRUCache {\n  constructor (options) {\n    if (typeof options === 'number')\n      options = { max: options }\n\n    if (!options)\n      options = {}\n\n    if (options.max && (typeof options.max !== 'number' || options.max < 0))\n      throw new TypeError('max must be a non-negative number')\n    // Kind of weird to have a default max of Infinity, but oh well.\n    const max = this[MAX] = options.max || Infinity\n\n    const lc = options.length || naiveLength\n    this[LENGTH_CALCULATOR] = (typeof lc !== 'function') ? naiveLength : lc\n    this[ALLOW_STALE] = options.stale || false\n    if (options.maxAge && typeof options.maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n    this[MAX_AGE] = options.maxAge || 0\n    this[DISPOSE] = options.dispose\n    this[NO_DISPOSE_ON_SET] = options.noDisposeOnSet || false\n    this[UPDATE_AGE_ON_GET] = options.updateAgeOnGet || false\n    this.reset()\n  }\n\n  // resize the cache when the max changes.\n  set max (mL) {\n    if (typeof mL !== 'number' || mL < 0)\n      throw new TypeError('max must be a non-negative number')\n\n    this[MAX] = mL || Infinity\n    trim(this)\n  }\n  get max () {\n    return this[MAX]\n  }\n\n  set allowStale (allowStale) {\n    this[ALLOW_STALE] = !!allowStale\n  }\n  get allowStale () {\n    return this[ALLOW_STALE]\n  }\n\n  set maxAge (mA) {\n    if (typeof mA !== 'number')\n      throw new TypeError('maxAge must be a non-negative number')\n\n    this[MAX_AGE] = mA\n    trim(this)\n  }\n  get maxAge () {\n    return this[MAX_AGE]\n  }\n\n  // resize the cache when the lengthCalculator changes.\n  set lengthCalculator (lC) {\n    if (typeof lC !== 'function')\n      lC = naiveLength\n\n    if (lC !== this[LENGTH_CALCULATOR]) {\n      this[LENGTH_CALCULATOR] = lC\n      this[LENGTH] = 0\n      this[LRU_LIST].forEach(hit => {\n        hit.length = this[LENGTH_CALCULATOR](hit.value, hit.key)\n        this[LENGTH] += hit.length\n      })\n    }\n    trim(this)\n  }\n  get lengthCalculator () { return this[LENGTH_CALCULATOR] }\n\n  get length () { return this[LENGTH] }\n  get itemCount () { return this[LRU_LIST].length }\n\n  rforEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].tail; walker !== null;) {\n      const prev = walker.prev\n      forEachStep(this, fn, walker, thisp)\n      walker = prev\n    }\n  }\n\n  forEach (fn, thisp) {\n    thisp = thisp || this\n    for (let walker = this[LRU_LIST].head; walker !== null;) {\n      const next = walker.next\n      forEachStep(this, fn, walker, thisp)\n      walker = next\n    }\n  }\n\n  keys () {\n    return this[LRU_LIST].toArray().map(k => k.key)\n  }\n\n  values () {\n    return this[LRU_LIST].toArray().map(k => k.value)\n  }\n\n  reset () {\n    if (this[DISPOSE] &&\n        this[LRU_LIST] &&\n        this[LRU_LIST].length) {\n      this[LRU_LIST].forEach(hit => this[DISPOSE](hit.key, hit.value))\n    }\n\n    this[CACHE] = new Map() // hash of items by key\n    this[LRU_LIST] = new Yallist() // list of items in order of use recency\n    this[LENGTH] = 0 // length of items in the list\n  }\n\n  dump () {\n    return this[LRU_LIST].map(hit =>\n      isStale(this, hit) ? false : {\n        k: hit.key,\n        v: hit.value,\n        e: hit.now + (hit.maxAge || 0)\n      }).toArray().filter(h => h)\n  }\n\n  dumpLru () {\n    return this[LRU_LIST]\n  }\n\n  set (key, value, maxAge) {\n    maxAge = maxAge || this[MAX_AGE]\n\n    if (maxAge && typeof maxAge !== 'number')\n      throw new TypeError('maxAge must be a number')\n\n    const now = maxAge ? Date.now() : 0\n    const len = this[LENGTH_CALCULATOR](value, key)\n\n    if (this[CACHE].has(key)) {\n      if (len > this[MAX]) {\n        del(this, this[CACHE].get(key))\n        return false\n      }\n\n      const node = this[CACHE].get(key)\n      const item = node.value\n\n      // dispose of the old one before overwriting\n      // split out into 2 ifs for better coverage tracking\n      if (this[DISPOSE]) {\n        if (!this[NO_DISPOSE_ON_SET])\n          this[DISPOSE](key, item.value)\n      }\n\n      item.now = now\n      item.maxAge = maxAge\n      item.value = value\n      this[LENGTH] += len - item.length\n      item.length = len\n      this.get(key)\n      trim(this)\n      return true\n    }\n\n    const hit = new Entry(key, value, len, now, maxAge)\n\n    // oversized objects fall out of cache automatically.\n    if (hit.length > this[MAX]) {\n      if (this[DISPOSE])\n        this[DISPOSE](key, value)\n\n      return false\n    }\n\n    this[LENGTH] += hit.length\n    this[LRU_LIST].unshift(hit)\n    this[CACHE].set(key, this[LRU_LIST].head)\n    trim(this)\n    return true\n  }\n\n  has (key) {\n    if (!this[CACHE].has(key)) return false\n    const hit = this[CACHE].get(key).value\n    return !isStale(this, hit)\n  }\n\n  get (key) {\n    return get(this, key, true)\n  }\n\n  peek (key) {\n    return get(this, key, false)\n  }\n\n  pop () {\n    const node = this[LRU_LIST].tail\n    if (!node)\n      return null\n\n    del(this, node)\n    return node.value\n  }\n\n  del (key) {\n    del(this, this[CACHE].get(key))\n  }\n\n  load (arr) {\n    // reset the cache\n    this.reset()\n\n    const now = Date.now()\n    // A previous serialized cache has the most recent items first\n    for (let l = arr.length - 1; l >= 0; l--) {\n      const hit = arr[l]\n      const expiresAt = hit.e || 0\n      if (expiresAt === 0)\n        // the item was created without expiration in a non aged cache\n        this.set(hit.k, hit.v)\n      else {\n        const maxAge = expiresAt - now\n        // dont add already expired items\n        if (maxAge > 0) {\n          this.set(hit.k, hit.v, maxAge)\n        }\n      }\n    }\n  }\n\n  prune () {\n    this[CACHE].forEach((value, key) => get(this, key, false))\n  }\n}\n\nconst get = (self, key, doUse) => {\n  const node = self[CACHE].get(key)\n  if (node) {\n    const hit = node.value\n    if (isStale(self, hit)) {\n      del(self, node)\n      if (!self[ALLOW_STALE])\n        return undefined\n    } else {\n      if (doUse) {\n        if (self[UPDATE_AGE_ON_GET])\n          node.value.now = Date.now()\n        self[LRU_LIST].unshiftNode(node)\n      }\n    }\n    return hit.value\n  }\n}\n\nconst isStale = (self, hit) => {\n  if (!hit || (!hit.maxAge && !self[MAX_AGE]))\n    return false\n\n  const diff = Date.now() - hit.now\n  return hit.maxAge ? diff > hit.maxAge\n    : self[MAX_AGE] && (diff > self[MAX_AGE])\n}\n\nconst trim = self => {\n  if (self[LENGTH] > self[MAX]) {\n    for (let walker = self[LRU_LIST].tail;\n      self[LENGTH] > self[MAX] && walker !== null;) {\n      // We know that we're about to delete this one, and also\n      // what the next least recently used key will be, so just\n      // go ahead and set it now.\n      const prev = walker.prev\n      del(self, walker)\n      walker = prev\n    }\n  }\n}\n\nconst del = (self, node) => {\n  if (node) {\n    const hit = node.value\n    if (self[DISPOSE])\n      self[DISPOSE](hit.key, hit.value)\n\n    self[LENGTH] -= hit.length\n    self[CACHE].delete(hit.key)\n    self[LRU_LIST].removeNode(node)\n  }\n}\n\nclass Entry {\n  constructor (key, value, length, now, maxAge) {\n    this.key = key\n    this.value = value\n    this.length = length\n    this.now = now\n    this.maxAge = maxAge || 0\n  }\n}\n\nconst forEachStep = (self, fn, node, thisp) => {\n  let hit = node.value\n  if (isStale(self, hit)) {\n    del(self, node)\n    if (!self[ALLOW_STALE])\n      hit = undefined\n  }\n  if (hit)\n    fn.call(thisp, hit.value, hit.key, self)\n}\n\nmodule.exports = LRUCache\n","// hoisted class for cyclic dependency\nclass Range {\n  constructor (range, options) {\n    options = parseOptions(options)\n\n    if (range instanceof Range) {\n      if (\n        range.loose === !!options.loose &&\n        range.includePrerelease === !!options.includePrerelease\n      ) {\n        return range\n      } else {\n        return new Range(range.raw, options)\n      }\n    }\n\n    if (range instanceof Comparator) {\n      // just put it in the set and return\n      this.raw = range.value\n      this.set = [[range]]\n      this.format()\n      return this\n    }\n\n    this.options = options\n    this.loose = !!options.loose\n    this.includePrerelease = !!options.includePrerelease\n\n    // First reduce all whitespace as much as possible so we do not have to rely\n    // on potentially slow regexes like \\s*. This is then stored and used for\n    // future error messages as well.\n    this.raw = range\n      .trim()\n      .split(/\\s+/)\n      .join(' ')\n\n    // First, split on ||\n    this.set = this.raw\n      .split('||')\n      // map the range to a 2d array of comparators\n      .map(r => this.parseRange(r.trim()))\n      // throw out any comparator lists that are empty\n      // this generally means that it was not a valid range, which is allowed\n      // in loose mode, but will still throw if the WHOLE range is invalid.\n      .filter(c => c.length)\n\n    if (!this.set.length) {\n      throw new TypeError(`Invalid SemVer Range: ${this.raw}`)\n    }\n\n    // if we have any that are not the null set, throw out null sets.\n    if (this.set.length > 1) {\n      // keep the first one, in case they're all null sets\n      const first = this.set[0]\n      this.set = this.set.filter(c => !isNullSet(c[0]))\n      if (this.set.length === 0) {\n        this.set = [first]\n      } else if (this.set.length > 1) {\n        // if we have any that are *, then the range is just *\n        for (const c of this.set) {\n          if (c.length === 1 && isAny(c[0])) {\n            this.set = [c]\n            break\n          }\n        }\n      }\n    }\n\n    this.format()\n  }\n\n  format () {\n    this.range = this.set\n      .map((comps) => comps.join(' ').trim())\n      .join('||')\n      .trim()\n    return this.range\n  }\n\n  toString () {\n    return this.range\n  }\n\n  parseRange (range) {\n    // memoize range parsing for performance.\n    // this is a very hot path, and fully deterministic.\n    const memoOpts =\n      (this.options.includePrerelease && FLAG_INCLUDE_PRERELEASE) |\n      (this.options.loose && FLAG_LOOSE)\n    const memoKey = memoOpts + ':' + range\n    const cached = cache.get(memoKey)\n    if (cached) {\n      return cached\n    }\n\n    const loose = this.options.loose\n    // `1.2.3 - 1.2.4` => `>=1.2.3 <=1.2.4`\n    const hr = loose ? re[t.HYPHENRANGELOOSE] : re[t.HYPHENRANGE]\n    range = range.replace(hr, hyphenReplace(this.options.includePrerelease))\n    debug('hyphen replace', range)\n\n    // `> 1.2.3 < 1.2.5` => `>1.2.3 <1.2.5`\n    range = range.replace(re[t.COMPARATORTRIM], comparatorTrimReplace)\n    debug('comparator trim', range)\n\n    // `~ 1.2.3` => `~1.2.3`\n    range = range.replace(re[t.TILDETRIM], tildeTrimReplace)\n    debug('tilde trim', range)\n\n    // `^ 1.2.3` => `^1.2.3`\n    range = range.replace(re[t.CARETTRIM], caretTrimReplace)\n    debug('caret trim', range)\n\n    // At this point, the range is completely trimmed and\n    // ready to be split into comparators.\n\n    let rangeList = range\n      .split(' ')\n      .map(comp => parseComparator(comp, this.options))\n      .join(' ')\n      .split(/\\s+/)\n      // >=0.0.0 is equivalent to *\n      .map(comp => replaceGTE0(comp, this.options))\n\n    if (loose) {\n      // in loose mode, throw out any that are not valid comparators\n      rangeList = rangeList.filter(comp => {\n        debug('loose invalid filter', comp, this.options)\n        return !!comp.match(re[t.COMPARATORLOOSE])\n      })\n    }\n    debug('range list', rangeList)\n\n    // if any comparators are the null set, then replace with JUST null set\n    // if more than one comparator, remove any * comparators\n    // also, don't include the same comparator more than once\n    const rangeMap = new Map()\n    const comparators = rangeList.map(comp => new Comparator(comp, this.options))\n    for (const comp of comparators) {\n      if (isNullSet(comp)) {\n        return [comp]\n      }\n      rangeMap.set(comp.value, comp)\n    }\n    if (rangeMap.size > 1 && rangeMap.has('')) {\n      rangeMap.delete('')\n    }\n\n    const result = [...rangeMap.values()]\n    cache.set(memoKey, result)\n    return result\n  }\n\n  intersects (range, options) {\n    if (!(range instanceof Range)) {\n      throw new TypeError('a Range is required')\n    }\n\n    return this.set.some((thisComparators) => {\n      return (\n        isSatisfiable(thisComparators, options) &&\n        range.set.some((rangeComparators) => {\n          return (\n            isSatisfiable(rangeComparators, options) &&\n            thisComparators.every((thisComparator) => {\n              return rangeComparators.every((rangeComparator) => {\n                return thisComparator.intersects(rangeComparator, options)\n              })\n            })\n          )\n        })\n      )\n    })\n  }\n\n  // if ANY of the sets match ALL of its comparators, then pass\n  test (version) {\n    if (!version) {\n      return false\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    for (let i = 0; i < this.set.length; i++) {\n      if (testSet(this.set[i], version, this.options)) {\n        return true\n      }\n    }\n    return false\n  }\n}\n\nmodule.exports = Range\n\nconst LRU = require('lru-cache')\nconst cache = new LRU({ max: 1000 })\n\nconst parseOptions = require('../internal/parse-options')\nconst Comparator = require('./comparator')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst {\n  safeRe: re,\n  t,\n  comparatorTrimReplace,\n  tildeTrimReplace,\n  caretTrimReplace,\n} = require('../internal/re')\nconst { FLAG_INCLUDE_PRERELEASE, FLAG_LOOSE } = require('../internal/constants')\n\nconst isNullSet = c => c.value === '<0.0.0-0'\nconst isAny = c => c.value === ''\n\n// take a set of comparators and determine whether there\n// exists a version which can satisfy it\nconst isSatisfiable = (comparators, options) => {\n  let result = true\n  const remainingComparators = comparators.slice()\n  let testComparator = remainingComparators.pop()\n\n  while (result && remainingComparators.length) {\n    result = remainingComparators.every((otherComparator) => {\n      return testComparator.intersects(otherComparator, options)\n    })\n\n    testComparator = remainingComparators.pop()\n  }\n\n  return result\n}\n\n// comprised of xranges, tildes, stars, and gtlt's at this point.\n// already replaced the hyphen ranges\n// turn into a set of JUST comparators.\nconst parseComparator = (comp, options) => {\n  debug('comp', comp, options)\n  comp = replaceCarets(comp, options)\n  debug('caret', comp)\n  comp = replaceTildes(comp, options)\n  debug('tildes', comp)\n  comp = replaceXRanges(comp, options)\n  debug('xrange', comp)\n  comp = replaceStars(comp, options)\n  debug('stars', comp)\n  return comp\n}\n\nconst isX = id => !id || id.toLowerCase() === 'x' || id === '*'\n\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0-0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0-0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0-0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0-0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0-0\n// ~0.0.1 --> >=0.0.1 <0.1.0-0\nconst replaceTildes = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceTilde(c, options))\n    .join(' ')\n}\n\nconst replaceTilde = (comp, options) => {\n  const r = options.loose ? re[t.TILDELOOSE] : re[t.TILDE]\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('tilde', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0 <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0-0\n      ret = `>=${M}.${m}.0 <${M}.${+m + 1}.0-0`\n    } else if (pr) {\n      debug('replaceTilde pr', pr)\n      ret = `>=${M}.${m}.${p}-${pr\n      } <${M}.${+m + 1}.0-0`\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0-0\n      ret = `>=${M}.${m}.${p\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('tilde return', ret)\n    return ret\n  })\n}\n\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0-0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0-0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0-0\n// ^1.2.3 --> >=1.2.3 <2.0.0-0\n// ^1.2.0 --> >=1.2.0 <2.0.0-0\n// ^0.0.1 --> >=0.0.1 <0.0.2-0\n// ^0.1.0 --> >=0.1.0 <0.2.0-0\nconst replaceCarets = (comp, options) => {\n  return comp\n    .trim()\n    .split(/\\s+/)\n    .map((c) => replaceCaret(c, options))\n    .join(' ')\n}\n\nconst replaceCaret = (comp, options) => {\n  debug('caret', comp, options)\n  const r = options.loose ? re[t.CARETLOOSE] : re[t.CARET]\n  const z = options.includePrerelease ? '-0' : ''\n  return comp.replace(r, (_, M, m, p, pr) => {\n    debug('caret', comp, _, M, m, p, pr)\n    let ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = `>=${M}.0.0${z} <${+M + 1}.0.0-0`\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = `>=${M}.${m}.0${z} <${M}.${+m + 1}.0-0`\n      } else {\n        ret = `>=${M}.${m}.0${z} <${+M + 1}.0.0-0`\n      }\n    } else if (pr) {\n      debug('replaceCaret pr', pr)\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p}-${pr\n          } <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p}-${pr\n        } <${+M + 1}.0.0-0`\n      }\n    } else {\n      debug('no pr')\n      if (M === '0') {\n        if (m === '0') {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${m}.${+p + 1}-0`\n        } else {\n          ret = `>=${M}.${m}.${p\n          }${z} <${M}.${+m + 1}.0-0`\n        }\n      } else {\n        ret = `>=${M}.${m}.${p\n        } <${+M + 1}.0.0-0`\n      }\n    }\n\n    debug('caret return', ret)\n    return ret\n  })\n}\n\nconst replaceXRanges = (comp, options) => {\n  debug('replaceXRanges', comp, options)\n  return comp\n    .split(/\\s+/)\n    .map((c) => replaceXRange(c, options))\n    .join(' ')\n}\n\nconst replaceXRange = (comp, options) => {\n  comp = comp.trim()\n  const r = options.loose ? re[t.XRANGELOOSE] : re[t.XRANGE]\n  return comp.replace(r, (ret, gtlt, M, m, p, pr) => {\n    debug('xRange', comp, ret, gtlt, M, m, p, pr)\n    const xM = isX(M)\n    const xm = xM || isX(m)\n    const xp = xm || isX(p)\n    const anyX = xp\n\n    if (gtlt === '=' && anyX) {\n      gtlt = ''\n    }\n\n    // if we're including prereleases in the match, then we need\n    // to fix this to -0, the lowest possible prerelease value\n    pr = options.includePrerelease ? '-0' : ''\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0-0'\n      } else {\n        // nothing is forbidden\n        ret = '*'\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0\n      }\n      p = 0\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        gtlt = '>='\n        if (xm) {\n          M = +M + 1\n          m = 0\n          p = 0\n        } else {\n          m = +m + 1\n          p = 0\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<'\n        if (xm) {\n          M = +M + 1\n        } else {\n          m = +m + 1\n        }\n      }\n\n      if (gtlt === '<') {\n        pr = '-0'\n      }\n\n      ret = `${gtlt + M}.${m}.${p}${pr}`\n    } else if (xm) {\n      ret = `>=${M}.0.0${pr} <${+M + 1}.0.0-0`\n    } else if (xp) {\n      ret = `>=${M}.${m}.0${pr\n      } <${M}.${+m + 1}.0-0`\n    }\n\n    debug('xRange return', ret)\n\n    return ret\n  })\n}\n\n// Because * is AND-ed with everything else in the comparator,\n// and '' means \"any version\", just remove the *s entirely.\nconst replaceStars = (comp, options) => {\n  debug('replaceStars', comp, options)\n  // Looseness is ignored here.  star is always as loose as it gets!\n  return comp\n    .trim()\n    .replace(re[t.STAR], '')\n}\n\nconst replaceGTE0 = (comp, options) => {\n  debug('replaceGTE0', comp, options)\n  return comp\n    .trim()\n    .replace(re[options.includePrerelease ? t.GTE0PRE : t.GTE0], '')\n}\n\n// This function is passed to string.replace(re[t.HYPHENRANGE])\n// M, m, patch, prerelease, build\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0-0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0-0\nconst hyphenReplace = incPr => ($0,\n  from, fM, fm, fp, fpr, fb,\n  to, tM, tm, tp, tpr, tb) => {\n  if (isX(fM)) {\n    from = ''\n  } else if (isX(fm)) {\n    from = `>=${fM}.0.0${incPr ? '-0' : ''}`\n  } else if (isX(fp)) {\n    from = `>=${fM}.${fm}.0${incPr ? '-0' : ''}`\n  } else if (fpr) {\n    from = `>=${from}`\n  } else {\n    from = `>=${from}${incPr ? '-0' : ''}`\n  }\n\n  if (isX(tM)) {\n    to = ''\n  } else if (isX(tm)) {\n    to = `<${+tM + 1}.0.0-0`\n  } else if (isX(tp)) {\n    to = `<${tM}.${+tm + 1}.0-0`\n  } else if (tpr) {\n    to = `<=${tM}.${tm}.${tp}-${tpr}`\n  } else if (incPr) {\n    to = `<${tM}.${tm}.${+tp + 1}-0`\n  } else {\n    to = `<=${to}`\n  }\n\n  return `${from} ${to}`.trim()\n}\n\nconst testSet = (set, version, options) => {\n  for (let i = 0; i < set.length; i++) {\n    if (!set[i].test(version)) {\n      return false\n    }\n  }\n\n  if (version.prerelease.length && !options.includePrerelease) {\n    // Find the set of versions that are allowed to have prereleases\n    // For example, ^1.2.3-pr.1 desugars to >=1.2.3-pr.1 <2.0.0\n    // That should allow `1.2.3-pr.2` to pass.\n    // However, `1.2.4-alpha.notready` should NOT be allowed,\n    // even though it's within the range set by the comparators.\n    for (let i = 0; i < set.length; i++) {\n      debug(set[i].semver)\n      if (set[i].semver === Comparator.ANY) {\n        continue\n      }\n\n      if (set[i].semver.prerelease.length > 0) {\n        const allowed = set[i].semver\n        if (allowed.major === version.major &&\n            allowed.minor === version.minor &&\n            allowed.patch === version.patch) {\n          return true\n        }\n      }\n    }\n\n    // Version has a -pre, but it's not one of the ones we like.\n    return false\n  }\n\n  return true\n}\n","const ANY = Symbol('SemVer ANY')\n// hoisted class for cyclic dependency\nclass Comparator {\n  static get ANY () {\n    return ANY\n  }\n\n  constructor (comp, options) {\n    options = parseOptions(options)\n\n    if (comp instanceof Comparator) {\n      if (comp.loose === !!options.loose) {\n        return comp\n      } else {\n        comp = comp.value\n      }\n    }\n\n    comp = comp.trim().split(/\\s+/).join(' ')\n    debug('comparator', comp, options)\n    this.options = options\n    this.loose = !!options.loose\n    this.parse(comp)\n\n    if (this.semver === ANY) {\n      this.value = ''\n    } else {\n      this.value = this.operator + this.semver.version\n    }\n\n    debug('comp', this)\n  }\n\n  parse (comp) {\n    const r = this.options.loose ? re[t.COMPARATORLOOSE] : re[t.COMPARATOR]\n    const m = comp.match(r)\n\n    if (!m) {\n      throw new TypeError(`Invalid comparator: ${comp}`)\n    }\n\n    this.operator = m[1] !== undefined ? m[1] : ''\n    if (this.operator === '=') {\n      this.operator = ''\n    }\n\n    // if it literally is just '>' or '' then allow anything.\n    if (!m[2]) {\n      this.semver = ANY\n    } else {\n      this.semver = new SemVer(m[2], this.options.loose)\n    }\n  }\n\n  toString () {\n    return this.value\n  }\n\n  test (version) {\n    debug('Comparator.test', version, this.options.loose)\n\n    if (this.semver === ANY || version === ANY) {\n      return true\n    }\n\n    if (typeof version === 'string') {\n      try {\n        version = new SemVer(version, this.options)\n      } catch (er) {\n        return false\n      }\n    }\n\n    return cmp(version, this.operator, this.semver, this.options)\n  }\n\n  intersects (comp, options) {\n    if (!(comp instanceof Comparator)) {\n      throw new TypeError('a Comparator is required')\n    }\n\n    if (this.operator === '') {\n      if (this.value === '') {\n        return true\n      }\n      return new Range(comp.value, options).test(this.value)\n    } else if (comp.operator === '') {\n      if (comp.value === '') {\n        return true\n      }\n      return new Range(this.value, options).test(comp.semver)\n    }\n\n    options = parseOptions(options)\n\n    // Special cases where nothing can possibly be lower\n    if (options.includePrerelease &&\n      (this.value === '<0.0.0-0' || comp.value === '<0.0.0-0')) {\n      return false\n    }\n    if (!options.includePrerelease &&\n      (this.value.startsWith('<0.0.0') || comp.value.startsWith('<0.0.0'))) {\n      return false\n    }\n\n    // Same direction increasing (> or >=)\n    if (this.operator.startsWith('>') && comp.operator.startsWith('>')) {\n      return true\n    }\n    // Same direction decreasing (< or <=)\n    if (this.operator.startsWith('<') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // same SemVer and both sides are inclusive (<= or >=)\n    if (\n      (this.semver.version === comp.semver.version) &&\n      this.operator.includes('=') && comp.operator.includes('=')) {\n      return true\n    }\n    // opposite directions less than\n    if (cmp(this.semver, '<', comp.semver, options) &&\n      this.operator.startsWith('>') && comp.operator.startsWith('<')) {\n      return true\n    }\n    // opposite directions greater than\n    if (cmp(this.semver, '>', comp.semver, options) &&\n      this.operator.startsWith('<') && comp.operator.startsWith('>')) {\n      return true\n    }\n    return false\n  }\n}\n\nmodule.exports = Comparator\n\nconst parseOptions = require('../internal/parse-options')\nconst { safeRe: re, t } = require('../internal/re')\nconst cmp = require('../functions/cmp')\nconst debug = require('../internal/debug')\nconst SemVer = require('./semver')\nconst Range = require('./range')\n","const Range = require('../classes/range.js')\nconst Comparator = require('../classes/comparator.js')\nconst { ANY } = Comparator\nconst satisfies = require('../functions/satisfies.js')\nconst compare = require('../functions/compare.js')\n\n// Complex range `r1 || r2 || ...` is a subset of `R1 || R2 || ...` iff:\n// - Every simple range `r1, r2, ...` is a null set, OR\n// - Every simple range `r1, r2, ...` which is not a null set is a subset of\n//   some `R1, R2, ...`\n//\n// Simple range `c1 c2 ...` is a subset of simple range `C1 C2 ...` iff:\n// - If c is only the ANY comparator\n//   - If C is only the ANY comparator, return true\n//   - Else if in prerelease mode, return false\n//   - else replace c with `[>=0.0.0]`\n// - If C is only the ANY comparator\n//   - if in prerelease mode, return true\n//   - else replace C with `[>=0.0.0]`\n// - Let EQ be the set of = comparators in c\n// - If EQ is more than one, return true (null set)\n// - Let GT be the highest > or >= comparator in c\n// - Let LT be the lowest < or <= comparator in c\n// - If GT and LT, and GT.semver > LT.semver, return true (null set)\n// - If any C is a = range, and GT or LT are set, return false\n// - If EQ\n//   - If GT, and EQ does not satisfy GT, return true (null set)\n//   - If LT, and EQ does not satisfy LT, return true (null set)\n//   - If EQ satisfies every C, return true\n//   - Else return false\n// - If GT\n//   - If GT.semver is lower than any > or >= comp in C, return false\n//   - If GT is >=, and GT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the GT.semver tuple, return false\n// - If LT\n//   - If LT.semver is greater than any < or <= comp in C, return false\n//   - If LT is <=, and LT.semver does not satisfy every C, return false\n//   - If GT.semver has a prerelease, and not in prerelease mode\n//     - If no C has a prerelease and the LT.semver tuple, return false\n// - Else return true\n\nconst subset = (sub, dom, options = {}) => {\n  if (sub === dom) {\n    return true\n  }\n\n  sub = new Range(sub, options)\n  dom = new Range(dom, options)\n  let sawNonNull = false\n\n  OUTER: for (const simpleSub of sub.set) {\n    for (const simpleDom of dom.set) {\n      const isSub = simpleSubset(simpleSub, simpleDom, options)\n      sawNonNull = sawNonNull || isSub !== null\n      if (isSub) {\n        continue OUTER\n      }\n    }\n    // the null set is a subset of everything, but null simple ranges in\n    // a complex range should be ignored.  so if we saw a non-null range,\n    // then we know this isn't a subset, but if EVERY simple range was null,\n    // then it is a subset.\n    if (sawNonNull) {\n      return false\n    }\n  }\n  return true\n}\n\nconst minimumVersionWithPreRelease = [new Comparator('>=0.0.0-0')]\nconst minimumVersion = [new Comparator('>=0.0.0')]\n\nconst simpleSubset = (sub, dom, options) => {\n  if (sub === dom) {\n    return true\n  }\n\n  if (sub.length === 1 && sub[0].semver === ANY) {\n    if (dom.length === 1 && dom[0].semver === ANY) {\n      return true\n    } else if (options.includePrerelease) {\n      sub = minimumVersionWithPreRelease\n    } else {\n      sub = minimumVersion\n    }\n  }\n\n  if (dom.length === 1 && dom[0].semver === ANY) {\n    if (options.includePrerelease) {\n      return true\n    } else {\n      dom = minimumVersion\n    }\n  }\n\n  const eqSet = new Set()\n  let gt, lt\n  for (const c of sub) {\n    if (c.operator === '>' || c.operator === '>=') {\n      gt = higherGT(gt, c, options)\n    } else if (c.operator === '<' || c.operator === '<=') {\n      lt = lowerLT(lt, c, options)\n    } else {\n      eqSet.add(c.semver)\n    }\n  }\n\n  if (eqSet.size > 1) {\n    return null\n  }\n\n  let gtltComp\n  if (gt && lt) {\n    gtltComp = compare(gt.semver, lt.semver, options)\n    if (gtltComp > 0) {\n      return null\n    } else if (gtltComp === 0 && (gt.operator !== '>=' || lt.operator !== '<=')) {\n      return null\n    }\n  }\n\n  // will iterate one or zero times\n  for (const eq of eqSet) {\n    if (gt && !satisfies(eq, String(gt), options)) {\n      return null\n    }\n\n    if (lt && !satisfies(eq, String(lt), options)) {\n      return null\n    }\n\n    for (const c of dom) {\n      if (!satisfies(eq, String(c), options)) {\n        return false\n      }\n    }\n\n    return true\n  }\n\n  let higher, lower\n  let hasDomLT, hasDomGT\n  // if the subset has a prerelease, we need a comparator in the superset\n  // with the same tuple and a prerelease, or it's not a subset\n  let needDomLTPre = lt &&\n    !options.includePrerelease &&\n    lt.semver.prerelease.length ? lt.semver : false\n  let needDomGTPre = gt &&\n    !options.includePrerelease &&\n    gt.semver.prerelease.length ? gt.semver : false\n  // exception: <1.2.3-0 is the same as <1.2.3\n  if (needDomLTPre && needDomLTPre.prerelease.length === 1 &&\n      lt.operator === '<' && needDomLTPre.prerelease[0] === 0) {\n    needDomLTPre = false\n  }\n\n  for (const c of dom) {\n    hasDomGT = hasDomGT || c.operator === '>' || c.operator === '>='\n    hasDomLT = hasDomLT || c.operator === '<' || c.operator === '<='\n    if (gt) {\n      if (needDomGTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomGTPre.major &&\n            c.semver.minor === needDomGTPre.minor &&\n            c.semver.patch === needDomGTPre.patch) {\n          needDomGTPre = false\n        }\n      }\n      if (c.operator === '>' || c.operator === '>=') {\n        higher = higherGT(gt, c, options)\n        if (higher === c && higher !== gt) {\n          return false\n        }\n      } else if (gt.operator === '>=' && !satisfies(gt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (lt) {\n      if (needDomLTPre) {\n        if (c.semver.prerelease && c.semver.prerelease.length &&\n            c.semver.major === needDomLTPre.major &&\n            c.semver.minor === needDomLTPre.minor &&\n            c.semver.patch === needDomLTPre.patch) {\n          needDomLTPre = false\n        }\n      }\n      if (c.operator === '<' || c.operator === '<=') {\n        lower = lowerLT(lt, c, options)\n        if (lower === c && lower !== lt) {\n          return false\n        }\n      } else if (lt.operator === '<=' && !satisfies(lt.semver, String(c), options)) {\n        return false\n      }\n    }\n    if (!c.operator && (lt || gt) && gtltComp !== 0) {\n      return false\n    }\n  }\n\n  // if there was a < or >, and nothing in the dom, then must be false\n  // UNLESS it was limited by another range in the other direction.\n  // Eg, >1.0.0 <1.0.1 is still a subset of <2.0.0\n  if (gt && hasDomLT && !lt && gtltComp !== 0) {\n    return false\n  }\n\n  if (lt && hasDomGT && !gt && gtltComp !== 0) {\n    return false\n  }\n\n  // we needed a prerelease range in a specific tuple, but didn't get one\n  // then this isn't a subset.  eg >=1.2.3-pre is not a subset of >=1.0.0,\n  // because it includes prereleases in the 1.2.3 tuple\n  if (needDomGTPre || needDomLTPre) {\n    return false\n  }\n\n  return true\n}\n\n// >=1.2.3 is lower than >1.2.3\nconst higherGT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp > 0 ? a\n    : comp < 0 ? b\n    : b.operator === '>' && a.operator === '>=' ? b\n    : a\n}\n\n// <=1.2.3 is higher than <1.2.3\nconst lowerLT = (a, b, options) => {\n  if (!a) {\n    return b\n  }\n  const comp = compare(a.semver, b.semver, options)\n  return comp < 0 ? a\n    : comp > 0 ? b\n    : b.operator === '<' && a.operator === '<=' ? b\n    : a\n}\n\nmodule.exports = subset\n","// just pre-load all the stuff that index.js lazily exports\nconst internalRe = require('./internal/re')\nconst constants = require('./internal/constants')\nconst SemVer = require('./classes/semver')\nconst identifiers = require('./internal/identifiers')\nconst parse = require('./functions/parse')\nconst valid = require('./functions/valid')\nconst clean = require('./functions/clean')\nconst inc = require('./functions/inc')\nconst diff = require('./functions/diff')\nconst major = require('./functions/major')\nconst minor = require('./functions/minor')\nconst patch = require('./functions/patch')\nconst prerelease = require('./functions/prerelease')\nconst compare = require('./functions/compare')\nconst rcompare = require('./functions/rcompare')\nconst compareLoose = require('./functions/compare-loose')\nconst compareBuild = require('./functions/compare-build')\nconst sort = require('./functions/sort')\nconst rsort = require('./functions/rsort')\nconst gt = require('./functions/gt')\nconst lt = require('./functions/lt')\nconst eq = require('./functions/eq')\nconst neq = require('./functions/neq')\nconst gte = require('./functions/gte')\nconst lte = require('./functions/lte')\nconst cmp = require('./functions/cmp')\nconst coerce = require('./functions/coerce')\nconst Comparator = require('./classes/comparator')\nconst Range = require('./classes/range')\nconst satisfies = require('./functions/satisfies')\nconst toComparators = require('./ranges/to-comparators')\nconst maxSatisfying = require('./ranges/max-satisfying')\nconst minSatisfying = require('./ranges/min-satisfying')\nconst minVersion = require('./ranges/min-version')\nconst validRange = require('./ranges/valid')\nconst outside = require('./ranges/outside')\nconst gtr = require('./ranges/gtr')\nconst ltr = require('./ranges/ltr')\nconst intersects = require('./ranges/intersects')\nconst simplifyRange = require('./ranges/simplify')\nconst subset = require('./ranges/subset')\nmodule.exports = {\n  parse,\n  valid,\n  clean,\n  inc,\n  diff,\n  major,\n  minor,\n  patch,\n  prerelease,\n  compare,\n  rcompare,\n  compareLoose,\n  compareBuild,\n  sort,\n  rsort,\n  gt,\n  lt,\n  eq,\n  neq,\n  gte,\n  lte,\n  cmp,\n  coerce,\n  Comparator,\n  Range,\n  satisfies,\n  toComparators,\n  maxSatisfying,\n  minSatisfying,\n  minVersion,\n  validRange,\n  outside,\n  gtr,\n  ltr,\n  intersects,\n  simplifyRange,\n  subset,\n  SemVer,\n  re: internalRe.re,\n  src: internalRe.src,\n  tokens: internalRe.t,\n  SEMVER_SPEC_VERSION: constants.SEMVER_SPEC_VERSION,\n  RELEASE_TYPES: constants.RELEASE_TYPES,\n  compareIdentifiers: identifiers.compareIdentifiers,\n  rcompareIdentifiers: identifiers.rcompareIdentifiers,\n}\n","const Range = require('../classes/range')\nconst satisfies = (version, range, options) => {\n  try {\n    range = new Range(range, options)\n  } catch (er) {\n    return false\n  }\n  return range.test(version)\n}\nmodule.exports = satisfies\n","const semver = require('semver');\n\nmodule.exports = semver.satisfies(process.version, '>=15.7.0');\n","const semver = require('semver');\n\nmodule.exports = semver.satisfies(process.version, '>=16.9.0');\n","const ASYMMETRIC_KEY_DETAILS_SUPPORTED = require('./asymmetricKeyDetailsSupported');\nconst RSA_PSS_KEY_DETAILS_SUPPORTED = require('./rsaPssKeyDetailsSupported');\n\nconst allowedAlgorithmsForKeys = {\n  'ec': ['ES256', 'ES384', 'ES512'],\n  'rsa': ['RS256', 'PS256', 'RS384', 'PS384', 'RS512', 'PS512'],\n  'rsa-pss': ['PS256', 'PS384', 'PS512']\n};\n\nconst allowedCurves = {\n  ES256: 'prime256v1',\n  ES384: 'secp384r1',\n  ES512: 'secp521r1',\n};\n\nmodule.exports = function(algorithm, key) {\n  if (!algorithm || !key) return;\n\n  const keyType = key.asymmetricKeyType;\n  if (!keyType) return;\n\n  const allowedAlgorithms = allowedAlgorithmsForKeys[keyType];\n\n  if (!allowedAlgorithms) {\n    throw new Error(`Unknown key type \"${keyType}\".`);\n  }\n\n  if (!allowedAlgorithms.includes(algorithm)) {\n    throw new Error(`\"alg\" parameter for \"${keyType}\" key type must be one of: ${allowedAlgorithms.join(', ')}.`)\n  }\n\n  /*\n   * Ignore the next block from test coverage because it gets executed\n   * conditionally depending on the Node version. Not ignoring it would\n   * prevent us from reaching the target % of coverage for versions of\n   * Node under 15.7.0.\n   */\n  /* istanbul ignore next */\n  if (ASYMMETRIC_KEY_DETAILS_SUPPORTED) {\n    switch (keyType) {\n    case 'ec':\n      const keyCurve = key.asymmetricKeyDetails.namedCurve;\n      const allowedCurve = allowedCurves[algorithm];\n\n      if (keyCurve !== allowedCurve) {\n        throw new Error(`\"alg\" parameter \"${algorithm}\" requires curve \"${allowedCurve}\".`);\n      }\n      break;\n\n    case 'rsa-pss':\n      if (RSA_PSS_KEY_DETAILS_SUPPORTED) {\n        const length = parseInt(algorithm.slice(-3), 10);\n        const { hashAlgorithm, mgf1HashAlgorithm, saltLength } = key.asymmetricKeyDetails;\n\n        if (hashAlgorithm !== `sha${length}` || mgf1HashAlgorithm !== hashAlgorithm) {\n          throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of \"alg\" ${algorithm}.`);\n        }\n\n        if (saltLength !== undefined && saltLength > length >> 3) {\n          throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of \"alg\" ${algorithm}.`)\n        }\n      }\n      break;\n    }\n  }\n}\n","var semver = require('semver');\n\nmodule.exports = semver.satisfies(process.version, '^6.12.0 || >=8.0.0');\n","const JsonWebTokenError = require('./lib/JsonWebTokenError');\nconst NotBeforeError = require('./lib/NotBeforeError');\nconst TokenExpiredError = require('./lib/TokenExpiredError');\nconst decode = require('./decode');\nconst timespan = require('./lib/timespan');\nconst validateAsymmetricKey = require('./lib/validateAsymmetricKey');\nconst PS_SUPPORTED = require('./lib/psSupported');\nconst jws = require('jws');\nconst {KeyObject, createSecretKey, createPublicKey} = require(\"crypto\");\n\nconst PUB_KEY_ALGS = ['RS256', 'RS384', 'RS512'];\nconst EC_KEY_ALGS = ['ES256', 'ES384', 'ES512'];\nconst RSA_KEY_ALGS = ['RS256', 'RS384', 'RS512'];\nconst HS_ALGS = ['HS256', 'HS384', 'HS512'];\n\nif (PS_SUPPORTED) {\n  PUB_KEY_ALGS.splice(PUB_KEY_ALGS.length, 0, 'PS256', 'PS384', 'PS512');\n  RSA_KEY_ALGS.splice(RSA_KEY_ALGS.length, 0, 'PS256', 'PS384', 'PS512');\n}\n\nmodule.exports = function (jwtString, secretOrPublicKey, options, callback) {\n  if ((typeof options === 'function') && !callback) {\n    callback = options;\n    options = {};\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  //clone this object since we are going to mutate it.\n  options = Object.assign({}, options);\n\n  let done;\n\n  if (callback) {\n    done = callback;\n  } else {\n    done = function(err, data) {\n      if (err) throw err;\n      return data;\n    };\n  }\n\n  if (options.clockTimestamp && typeof options.clockTimestamp !== 'number') {\n    return done(new JsonWebTokenError('clockTimestamp must be a number'));\n  }\n\n  if (options.nonce !== undefined && (typeof options.nonce !== 'string' || options.nonce.trim() === '')) {\n    return done(new JsonWebTokenError('nonce must be a non-empty string'));\n  }\n\n  if (options.allowInvalidAsymmetricKeyTypes !== undefined && typeof options.allowInvalidAsymmetricKeyTypes !== 'boolean') {\n    return done(new JsonWebTokenError('allowInvalidAsymmetricKeyTypes must be a boolean'));\n  }\n\n  const clockTimestamp = options.clockTimestamp || Math.floor(Date.now() / 1000);\n\n  if (!jwtString){\n    return done(new JsonWebTokenError('jwt must be provided'));\n  }\n\n  if (typeof jwtString !== 'string') {\n    return done(new JsonWebTokenError('jwt must be a string'));\n  }\n\n  const parts = jwtString.split('.');\n\n  if (parts.length !== 3){\n    return done(new JsonWebTokenError('jwt malformed'));\n  }\n\n  let decodedToken;\n\n  try {\n    decodedToken = decode(jwtString, { complete: true });\n  } catch(err) {\n    return done(err);\n  }\n\n  if (!decodedToken) {\n    return done(new JsonWebTokenError('invalid token'));\n  }\n\n  const header = decodedToken.header;\n  let getSecret;\n\n  if(typeof secretOrPublicKey === 'function') {\n    if(!callback) {\n      return done(new JsonWebTokenError('verify must be called asynchronous if secret or public key is provided as a callback'));\n    }\n\n    getSecret = secretOrPublicKey;\n  }\n  else {\n    getSecret = function(header, secretCallback) {\n      return secretCallback(null, secretOrPublicKey);\n    };\n  }\n\n  return getSecret(header, function(err, secretOrPublicKey) {\n    if(err) {\n      return done(new JsonWebTokenError('error in secret or public key callback: ' + err.message));\n    }\n\n    const hasSignature = parts[2].trim() !== '';\n\n    if (!hasSignature && secretOrPublicKey){\n      return done(new JsonWebTokenError('jwt signature is required'));\n    }\n\n    if (hasSignature && !secretOrPublicKey) {\n      return done(new JsonWebTokenError('secret or public key must be provided'));\n    }\n\n    if (!hasSignature && !options.algorithms) {\n      return done(new JsonWebTokenError('please specify \"none\" in \"algorithms\" to verify unsigned tokens'));\n    }\n\n    if (secretOrPublicKey != null && !(secretOrPublicKey instanceof KeyObject)) {\n      try {\n        secretOrPublicKey = createPublicKey(secretOrPublicKey);\n      } catch (_) {\n        try {\n          secretOrPublicKey = createSecretKey(typeof secretOrPublicKey === 'string' ? Buffer.from(secretOrPublicKey) : secretOrPublicKey);\n        } catch (_) {\n          return done(new JsonWebTokenError('secretOrPublicKey is not valid key material'))\n        }\n      }\n    }\n\n    if (!options.algorithms) {\n      if (secretOrPublicKey.type === 'secret') {\n        options.algorithms = HS_ALGS;\n      } else if (['rsa', 'rsa-pss'].includes(secretOrPublicKey.asymmetricKeyType)) {\n        options.algorithms = RSA_KEY_ALGS\n      } else if (secretOrPublicKey.asymmetricKeyType === 'ec') {\n        options.algorithms = EC_KEY_ALGS\n      } else {\n        options.algorithms = PUB_KEY_ALGS\n      }\n    }\n\n    if (options.algorithms.indexOf(decodedToken.header.alg) === -1) {\n      return done(new JsonWebTokenError('invalid algorithm'));\n    }\n\n    if (header.alg.startsWith('HS') && secretOrPublicKey.type !== 'secret') {\n      return done(new JsonWebTokenError((`secretOrPublicKey must be a symmetric key when using ${header.alg}`)))\n    } else if (/^(?:RS|PS|ES)/.test(header.alg) && secretOrPublicKey.type !== 'public') {\n      return done(new JsonWebTokenError((`secretOrPublicKey must be an asymmetric key when using ${header.alg}`)))\n    }\n\n    if (!options.allowInvalidAsymmetricKeyTypes) {\n      try {\n        validateAsymmetricKey(header.alg, secretOrPublicKey);\n      } catch (e) {\n        return done(e);\n      }\n    }\n\n    let valid;\n\n    try {\n      valid = jws.verify(jwtString, decodedToken.header.alg, secretOrPublicKey);\n    } catch (e) {\n      return done(e);\n    }\n\n    if (!valid) {\n      return done(new JsonWebTokenError('invalid signature'));\n    }\n\n    const payload = decodedToken.payload;\n\n    if (typeof payload.nbf !== 'undefined' && !options.ignoreNotBefore) {\n      if (typeof payload.nbf !== 'number') {\n        return done(new JsonWebTokenError('invalid nbf value'));\n      }\n      if (payload.nbf > clockTimestamp + (options.clockTolerance || 0)) {\n        return done(new NotBeforeError('jwt not active', new Date(payload.nbf * 1000)));\n      }\n    }\n\n    if (typeof payload.exp !== 'undefined' && !options.ignoreExpiration) {\n      if (typeof payload.exp !== 'number') {\n        return done(new JsonWebTokenError('invalid exp value'));\n      }\n      if (clockTimestamp >= payload.exp + (options.clockTolerance || 0)) {\n        return done(new TokenExpiredError('jwt expired', new Date(payload.exp * 1000)));\n      }\n    }\n\n    if (options.audience) {\n      const audiences = Array.isArray(options.audience) ? options.audience : [options.audience];\n      const target = Array.isArray(payload.aud) ? payload.aud : [payload.aud];\n\n      const match = target.some(function (targetAudience) {\n        return audiences.some(function (audience) {\n          return audience instanceof RegExp ? audience.test(targetAudience) : audience === targetAudience;\n        });\n      });\n\n      if (!match) {\n        return done(new JsonWebTokenError('jwt audience invalid. expected: ' + audiences.join(' or ')));\n      }\n    }\n\n    if (options.issuer) {\n      const invalid_issuer =\n              (typeof options.issuer === 'string' && payload.iss !== options.issuer) ||\n              (Array.isArray(options.issuer) && options.issuer.indexOf(payload.iss) === -1);\n\n      if (invalid_issuer) {\n        return done(new JsonWebTokenError('jwt issuer invalid. expected: ' + options.issuer));\n      }\n    }\n\n    if (options.subject) {\n      if (payload.sub !== options.subject) {\n        return done(new JsonWebTokenError('jwt subject invalid. expected: ' + options.subject));\n      }\n    }\n\n    if (options.jwtid) {\n      if (payload.jti !== options.jwtid) {\n        return done(new JsonWebTokenError('jwt jwtid invalid. expected: ' + options.jwtid));\n      }\n    }\n\n    if (options.nonce) {\n      if (payload.nonce !== options.nonce) {\n        return done(new JsonWebTokenError('jwt nonce invalid. expected: ' + options.nonce));\n      }\n    }\n\n    if (options.maxAge) {\n      if (typeof payload.iat !== 'number') {\n        return done(new JsonWebTokenError('iat required when maxAge is specified'));\n      }\n\n      const maxAgeTimestamp = timespan(options.maxAge, payload.iat);\n      if (typeof maxAgeTimestamp === 'undefined') {\n        return done(new JsonWebTokenError('\"maxAge\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n      }\n      if (clockTimestamp >= maxAgeTimestamp + (options.clockTolerance || 0)) {\n        return done(new TokenExpiredError('maxAge exceeded', new Date(maxAgeTimestamp * 1000)));\n      }\n    }\n\n    if (options.complete === true) {\n      const signature = decodedToken.signature;\n\n      return done(null, {\n        header: header,\n        payload: payload,\n        signature: signature\n      });\n    }\n\n    return done(null, payload);\n  });\n};\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_SAFE_INTEGER = 9007199254740991,\n    MAX_INTEGER = 1.7976931348623157e+308,\n    NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array ? array.length : 0,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  if (value !== value) {\n    return baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object),\n    nativeMax = Math.max;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  // Safari 9 makes `arguments.length` enumerable in strict mode.\n  var result = (isArray(value) || isArguments(value))\n    ? baseTimes(value.length, String)\n    : [];\n\n  var length = result.length,\n      skipIndexes = !!length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Checks if `value` is in `collection`. If `collection` is a string, it's\n * checked for a substring of `value`, otherwise\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * is used for equality comparisons. If `fromIndex` is negative, it's used as\n * the offset from the end of `collection`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object|string} collection The collection to inspect.\n * @param {*} value The value to search for.\n * @param {number} [fromIndex=0] The index to search from.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n * @returns {boolean} Returns `true` if `value` is found, else `false`.\n * @example\n *\n * _.includes([1, 2, 3], 1);\n * // => true\n *\n * _.includes([1, 2, 3], 1, 2);\n * // => false\n *\n * _.includes({ 'a': 1, 'b': 2 }, 1);\n * // => true\n *\n * _.includes('abcd', 'bc');\n * // => true\n */\nfunction includes(collection, value, fromIndex, guard) {\n  collection = isArrayLike(collection) ? collection : values(collection);\n  fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n  var length = collection.length;\n  if (fromIndex < 0) {\n    fromIndex = nativeMax(length + fromIndex, 0);\n  }\n  return isString(collection)\n    ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n    : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && objectToString.call(value) == stringTag);\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object ? baseValues(object, keys(object)) : [];\n}\n\nmodule.exports = includes;\n","/**\n * lodash 3.0.3 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is classified as a boolean primitive or object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isBoolean(false);\n * // => true\n *\n * _.isBoolean(null);\n * // => false\n */\nfunction isBoolean(value) {\n  return value === true || value === false ||\n    (isObjectLike(value) && objectToString.call(value) == boolTag);\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\nmodule.exports = isBoolean;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308,\n    NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is an integer.\n *\n * **Note:** This method is based on\n * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n * @example\n *\n * _.isInteger(3);\n * // => true\n *\n * _.isInteger(Number.MIN_VALUE);\n * // => false\n *\n * _.isInteger(Infinity);\n * // => false\n *\n * _.isInteger('3');\n * // => false\n */\nfunction isInteger(value) {\n  return typeof value == 'number' && value == toInteger(value);\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = isInteger;\n","/**\n * lodash 3.0.3 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are classified\n * as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && objectToString.call(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) ||\n      objectToString.call(value) != objectTag || isHostObject(value)) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return (typeof Ctor == 'function' &&\n    Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString);\n}\n\nmodule.exports = isPlainObject;\n","/**\n * lodash 4.0.1 (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the [`toStringTag`](http://ecma-international.org/ecma-262/6.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @type Function\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is correctly classified, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && objectToString.call(value) == stringTag);\n}\n\nmodule.exports = isString;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308,\n    NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/**\n * Creates a function that invokes `func`, with the `this` binding and arguments\n * of the created function, while it's called less than `n` times. Subsequent\n * calls to the created function return the result of the last `func` invocation.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Function\n * @param {number} n The number of calls at which `func` is no longer invoked.\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * jQuery(element).on('click', _.before(5, addContactToList));\n * // => Allows adding up to 4 contacts to the list.\n */\nfunction before(n, func) {\n  var result;\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  n = toInteger(n);\n  return function() {\n    if (--n > 0) {\n      result = func.apply(this, arguments);\n    }\n    if (n <= 1) {\n      func = undefined;\n    }\n    return result;\n  };\n}\n\n/**\n * Creates a function that is restricted to invoking `func` once. Repeat calls\n * to the function return the value of the first invocation. The `func` is\n * invoked with the `this` binding and arguments of the created function.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new restricted function.\n * @example\n *\n * var initialize = _.once(createApplication);\n * initialize();\n * initialize();\n * // => `createApplication` is invoked once\n */\nfunction once(func) {\n  return before(2, func);\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = once;\n","const timespan = require('./lib/timespan');\nconst PS_SUPPORTED = require('./lib/psSupported');\nconst validateAsymmetricKey = require('./lib/validateAsymmetricKey');\nconst jws = require('jws');\nconst includes = require('lodash.includes');\nconst isBoolean = require('lodash.isboolean');\nconst isInteger = require('lodash.isinteger');\nconst isNumber = require('lodash.isnumber');\nconst isPlainObject = require('lodash.isplainobject');\nconst isString = require('lodash.isstring');\nconst once = require('lodash.once');\nconst { KeyObject, createSecretKey, createPrivateKey } = require('crypto')\n\nconst SUPPORTED_ALGS = ['RS256', 'RS384', 'RS512', 'ES256', 'ES384', 'ES512', 'HS256', 'HS384', 'HS512', 'none'];\nif (PS_SUPPORTED) {\n  SUPPORTED_ALGS.splice(3, 0, 'PS256', 'PS384', 'PS512');\n}\n\nconst sign_options_schema = {\n  expiresIn: { isValid: function(value) { return isInteger(value) || (isString(value) && value); }, message: '\"expiresIn\" should be a number of seconds or string representing a timespan' },\n  notBefore: { isValid: function(value) { return isInteger(value) || (isString(value) && value); }, message: '\"notBefore\" should be a number of seconds or string representing a timespan' },\n  audience: { isValid: function(value) { return isString(value) || Array.isArray(value); }, message: '\"audience\" must be a string or array' },\n  algorithm: { isValid: includes.bind(null, SUPPORTED_ALGS), message: '\"algorithm\" must be a valid string enum value' },\n  header: { isValid: isPlainObject, message: '\"header\" must be an object' },\n  encoding: { isValid: isString, message: '\"encoding\" must be a string' },\n  issuer: { isValid: isString, message: '\"issuer\" must be a string' },\n  subject: { isValid: isString, message: '\"subject\" must be a string' },\n  jwtid: { isValid: isString, message: '\"jwtid\" must be a string' },\n  noTimestamp: { isValid: isBoolean, message: '\"noTimestamp\" must be a boolean' },\n  keyid: { isValid: isString, message: '\"keyid\" must be a string' },\n  mutatePayload: { isValid: isBoolean, message: '\"mutatePayload\" must be a boolean' },\n  allowInsecureKeySizes: { isValid: isBoolean, message: '\"allowInsecureKeySizes\" must be a boolean'},\n  allowInvalidAsymmetricKeyTypes: { isValid: isBoolean, message: '\"allowInvalidAsymmetricKeyTypes\" must be a boolean'}\n};\n\nconst registered_claims_schema = {\n  iat: { isValid: isNumber, message: '\"iat\" should be a number of seconds' },\n  exp: { isValid: isNumber, message: '\"exp\" should be a number of seconds' },\n  nbf: { isValid: isNumber, message: '\"nbf\" should be a number of seconds' }\n};\n\nfunction validate(schema, allowUnknown, object, parameterName) {\n  if (!isPlainObject(object)) {\n    throw new Error('Expected \"' + parameterName + '\" to be a plain object.');\n  }\n  Object.keys(object)\n    .forEach(function(key) {\n      const validator = schema[key];\n      if (!validator) {\n        if (!allowUnknown) {\n          throw new Error('\"' + key + '\" is not allowed in \"' + parameterName + '\"');\n        }\n        return;\n      }\n      if (!validator.isValid(object[key])) {\n        throw new Error(validator.message);\n      }\n    });\n}\n\nfunction validateOptions(options) {\n  return validate(sign_options_schema, false, options, 'options');\n}\n\nfunction validatePayload(payload) {\n  return validate(registered_claims_schema, true, payload, 'payload');\n}\n\nconst options_to_payload = {\n  'audience': 'aud',\n  'issuer': 'iss',\n  'subject': 'sub',\n  'jwtid': 'jti'\n};\n\nconst options_for_objects = [\n  'expiresIn',\n  'notBefore',\n  'noTimestamp',\n  'audience',\n  'issuer',\n  'subject',\n  'jwtid',\n];\n\nmodule.exports = function (payload, secretOrPrivateKey, options, callback) {\n  if (typeof options === 'function') {\n    callback = options;\n    options = {};\n  } else {\n    options = options || {};\n  }\n\n  const isObjectPayload = typeof payload === 'object' &&\n                        !Buffer.isBuffer(payload);\n\n  const header = Object.assign({\n    alg: options.algorithm || 'HS256',\n    typ: isObjectPayload ? 'JWT' : undefined,\n    kid: options.keyid\n  }, options.header);\n\n  function failure(err) {\n    if (callback) {\n      return callback(err);\n    }\n    throw err;\n  }\n\n  if (!secretOrPrivateKey && options.algorithm !== 'none') {\n    return failure(new Error('secretOrPrivateKey must have a value'));\n  }\n\n  if (secretOrPrivateKey != null && !(secretOrPrivateKey instanceof KeyObject)) {\n    try {\n      secretOrPrivateKey = createPrivateKey(secretOrPrivateKey)\n    } catch (_) {\n      try {\n        secretOrPrivateKey = createSecretKey(typeof secretOrPrivateKey === 'string' ? Buffer.from(secretOrPrivateKey) : secretOrPrivateKey)\n      } catch (_) {\n        return failure(new Error('secretOrPrivateKey is not valid key material'));\n      }\n    }\n  }\n\n  if (header.alg.startsWith('HS') && secretOrPrivateKey.type !== 'secret') {\n    return failure(new Error((`secretOrPrivateKey must be a symmetric key when using ${header.alg}`)))\n  } else if (/^(?:RS|PS|ES)/.test(header.alg)) {\n    if (secretOrPrivateKey.type !== 'private') {\n      return failure(new Error((`secretOrPrivateKey must be an asymmetric key when using ${header.alg}`)))\n    }\n    if (!options.allowInsecureKeySizes &&\n      !header.alg.startsWith('ES') &&\n      secretOrPrivateKey.asymmetricKeyDetails !== undefined && //KeyObject.asymmetricKeyDetails is supported in Node 15+\n      secretOrPrivateKey.asymmetricKeyDetails.modulusLength < 2048) {\n      return failure(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${header.alg}`));\n    }\n  }\n\n  if (typeof payload === 'undefined') {\n    return failure(new Error('payload is required'));\n  } else if (isObjectPayload) {\n    try {\n      validatePayload(payload);\n    }\n    catch (error) {\n      return failure(error);\n    }\n    if (!options.mutatePayload) {\n      payload = Object.assign({},payload);\n    }\n  } else {\n    const invalid_options = options_for_objects.filter(function (opt) {\n      return typeof options[opt] !== 'undefined';\n    });\n\n    if (invalid_options.length > 0) {\n      return failure(new Error('invalid ' + invalid_options.join(',') + ' option for ' + (typeof payload ) + ' payload'));\n    }\n  }\n\n  if (typeof payload.exp !== 'undefined' && typeof options.expiresIn !== 'undefined') {\n    return failure(new Error('Bad \"options.expiresIn\" option the payload already has an \"exp\" property.'));\n  }\n\n  if (typeof payload.nbf !== 'undefined' && typeof options.notBefore !== 'undefined') {\n    return failure(new Error('Bad \"options.notBefore\" option the payload already has an \"nbf\" property.'));\n  }\n\n  try {\n    validateOptions(options);\n  }\n  catch (error) {\n    return failure(error);\n  }\n\n  if (!options.allowInvalidAsymmetricKeyTypes) {\n    try {\n      validateAsymmetricKey(header.alg, secretOrPrivateKey);\n    } catch (error) {\n      return failure(error);\n    }\n  }\n\n  const timestamp = payload.iat || Math.floor(Date.now() / 1000);\n\n  if (options.noTimestamp) {\n    delete payload.iat;\n  } else if (isObjectPayload) {\n    payload.iat = timestamp;\n  }\n\n  if (typeof options.notBefore !== 'undefined') {\n    try {\n      payload.nbf = timespan(options.notBefore, timestamp);\n    }\n    catch (err) {\n      return failure(err);\n    }\n    if (typeof payload.nbf === 'undefined') {\n      return failure(new Error('\"notBefore\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  if (typeof options.expiresIn !== 'undefined' && typeof payload === 'object') {\n    try {\n      payload.exp = timespan(options.expiresIn, timestamp);\n    }\n    catch (err) {\n      return failure(err);\n    }\n    if (typeof payload.exp === 'undefined') {\n      return failure(new Error('\"expiresIn\" should be a number of seconds or string representing a timespan eg: \"1d\", \"20h\", 60'));\n    }\n  }\n\n  Object.keys(options_to_payload).forEach(function (key) {\n    const claim = options_to_payload[key];\n    if (typeof options[key] !== 'undefined') {\n      if (typeof payload[claim] !== 'undefined') {\n        return failure(new Error('Bad \"options.' + key + '\" option. The payload already has an \"' + claim + '\" property.'));\n      }\n      payload[claim] = options[key];\n    }\n  });\n\n  const encoding = options.encoding || 'utf8';\n\n  if (typeof callback === 'function') {\n    callback = callback && once(callback);\n\n    jws.createSign({\n      header: header,\n      privateKey: secretOrPrivateKey,\n      payload: payload,\n      encoding: encoding\n    }).once('error', callback)\n      .once('done', function (signature) {\n        // TODO: Remove in favor of the modulus length check before signing once node 15+ is the minimum supported version\n        if(!options.allowInsecureKeySizes && /^(?:RS|PS)/.test(header.alg) && signature.length < 256) {\n          return callback(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${header.alg}`))\n        }\n        callback(null, signature);\n      });\n  } else {\n    let signature = jws.sign({header: header, payload: payload, secret: secretOrPrivateKey, encoding: encoding});\n    // TODO: Remove in favor of the modulus length check before signing once node 15+ is the minimum supported version\n    if(!options.allowInsecureKeySizes && /^(?:RS|PS)/.test(header.alg) && signature.length < 256) {\n      throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${header.alg}`)\n    }\n    return signature\n  }\n};\n","module.exports = {\n  decode: require('./decode'),\n  verify: require('./verify'),\n  sign: require('./sign'),\n  JsonWebTokenError: require('./lib/JsonWebTokenError'),\n  NotBeforeError: require('./lib/NotBeforeError'),\n  TokenExpiredError: require('./lib/TokenExpiredError'),\n};\n","var jws = require('jws');\n\nmodule.exports = function (jwt, options) {\n  options = options || {};\n  var decoded = jws.decode(jwt, options);\n  if (!decoded) { return null; }\n  var payload = decoded.payload;\n\n  //try parse the payload\n  if(typeof payload === 'string') {\n    try {\n      var obj = JSON.parse(payload);\n      if(obj !== null && typeof obj === 'object') {\n        payload = obj;\n      }\n    } catch (e) { }\n  }\n\n  //return header if `complete` option is enabled.  header includes claims\n  //such as `kid` and `alg` used to select the key within a JWKS needed to\n  //verify the signature\n  if (options.complete === true) {\n    return {\n      header: decoded.header,\n      payload: payload,\n      signature: decoded.signature\n    };\n  }\n  return payload;\n};\n","/**\r\n * Example to refresh tokens using https://github.com/auth0/node-jsonwebtoken\r\n * It was requested to be introduced at as part of the jsonwebtoken library,\r\n * since we feel it does not add too much value but it will add code to mantain\r\n * we won't include it.\r\n *\r\n * I create this gist just to help those who want to auto-refresh JWTs.\r\n */\r\nimport jsonwebtoken from 'jsonwebtoken';\r\nimport * as uuid from 'uuid';\r\n\r\nexport default class TokenGenerator {\r\n\r\n    constructor(privateKey, options) {\r\n        this.privateKey = privateKey;\r\n        this.options = options;\r\n    }\r\n\r\n    sign(payload) {\r\n        const jwtSignOptions = { ...this.options, jwtid: uuid.v4() };\r\n        return jsonwebtoken.sign(payload, this.privateKey, jwtSignOptions);\r\n    }\r\n\r\n    verify(token) {\r\n        return jsonwebtoken.verify(token, this.privateKey, this.options);\r\n    }\r\n\r\n    refresh(token) {\r\n        const payload = jsonwebtoken.verify(token, this.privateKey, this.options);\r\n        delete payload.sub;\r\n        delete payload.iss;\r\n        delete payload.aud;\r\n        delete payload.iat;\r\n        delete payload.exp;\r\n        delete payload.nbf;\r\n        delete payload.jti; //We are generating a new token, if you are using jwtid during signing, pass it in refreshOptions\r\n        const jwtSignOptions = { ...this.options, jwtid: uuid.v4() };\r\n        // The first signing converted all needed options into claims, they are already in the payload\r\n        return jsonwebtoken.sign(payload, this.privateKey, jwtSignOptions);\r\n    }\r\n}\r\n","import helmet from \"helmet\";\r\nimport express from \"express\";\r\nimport compression from \"compression\";\r\nimport cors from \"cors\";\r\nimport fileUpload from \"express-fileupload\";\r\nimport url from \"url\";\r\nimport lodash from \"lodash\";\r\nimport { JsonResponse, Utils } from \"../common/index.js\";\r\n\r\n/**\r\n * Clase servidor encargada de configurar las rutas.\r\n *\r\n * que el codigo se disperse entre diferentes proyectos.\r\n */\r\nexport default class Server {\r\n    /**\r\n     *\r\n     * @param {*} config\r\n     * @param {*} statics\r\n     * @param {*} routes\r\n     */\r\n    constructor(config, statics, routes) {\r\n        this.app = express();\r\n        this.express_config = lodash.defaultsDeep(config, {\r\n            helmet: true,\r\n            json: true,\r\n            urlencoded: true,\r\n            compression: true,\r\n            cors: { origin: true, credentials: true },\r\n            fileupload: true,\r\n            socketio: { transports: [\"websocket\"] },\r\n            traceRequests: false,\r\n        });\r\n        this.statics = statics;\r\n        this.routes = routes;\r\n    }\r\n\r\n    /**\r\n     * Inicializa el servidor\r\n     */\r\n    async initialize() {\r\n        this.config(this.express_config);\r\n        if (this.customizeExpress) {\r\n            await this.customizeExpress(this.app);\r\n        }\r\n        await this.configureRoutes(this.routes);\r\n        await this.errorHandler();\r\n    }\r\n\r\n    /**\r\n     * Funcion sobreescribible para personalizar los componentes cargados en Express\r\n     *\r\n     * Aqui se pueden poner cosas como:\r\n     *\r\n     * this.app.use(cookieParser())... etc\r\n     */\r\n    customizeExpress() {}\r\n\r\n    /**\r\n     * Se encarga de realizar la configuración inicial del servidor\r\n     *\r\n     */\r\n    config(config) {\r\n        if (config && config.helmet) {\r\n            //Security\r\n            this.app.use(helmet(config && lodash.isObject(config.helmet) && config.helmet));\r\n        }\r\n        if (config && config.json) {\r\n            //mount json form parser\r\n            this.app.use(express.json());\r\n        }\r\n\r\n        if (config && config.urlencoded) {\r\n            //mount query string parser\r\n            this.app.use(express.urlencoded({ extended: true }));\r\n        }\r\n        if (config && config.compression) {\r\n            // compress responses\r\n            this.app.use(compression());\r\n        }\r\n        if (config && config.cors) {\r\n            //Enable cors to allow external references\r\n            this.app.options(\"*\", cors(config && lodash.isObject(config.cors) && config.cors));\r\n            this.app.use(cors(config && lodash.isObject(config.cors) && config.cors));\r\n        }\r\n        if (config && config.fileupload) {\r\n            // upload middleware\r\n            this.app.use(fileUpload());\r\n        }\r\n\r\n        if (this.statics) {\r\n            //add static paths\r\n            for (const idx in this.statics) {\r\n                this.app.use(idx, express.static(this.statics[idx]));\r\n            }\r\n        }\r\n\r\n        //Logging\r\n        if (config && config.traceRequests === true && process.env.DISABLE_LOGGER != \"true\") {\r\n            this.app.use((request, response, next) => {\r\n                request.requestTime = Date.now();\r\n                response.on(\"finish\", () => {\r\n                    let pathname = url.parse(request.url).pathname;\r\n                    let end = Date.now() - request.requestTime;\r\n                    let user = (request && request.session && request.session.user_id) || \"\";\r\n\r\n                    console.debug(\"APIRequest[\" + process.pid + \"]::. [\" + request.method + \"] (user:\" + user + \")  \" + pathname + \" |-> took: \" + end + \" ms\");\r\n                    console.debug(JSON.stringify(request.body));\r\n                });\r\n                next();\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Crea el cargador automatico de rutas\r\n     */\r\n    configureRoutes(routes) {\r\n        const router = express.Router();\r\n        this.app.use(router);\r\n\r\n        //create controllers\r\n        this.loadRoutes(this.app, routes);\r\n    }\r\n\r\n    /**\r\n     * Instancia la lista de rutas disponibles\r\n     * @param apps\r\n     * @returns {*}\r\n     */\r\n    loadRoutes(app, routes) {\r\n        if (!routes) return;\r\n\r\n        for (const route of routes) {\r\n            if (!route) {\r\n                console.warn(\"Empty route\");\r\n                continue;\r\n            }\r\n            let router = route.configure();\r\n\r\n            //perform autoconfig for base api crud operations\r\n            if (route.entity) {\r\n                router = route.configure(route.entity, { service: route.service, table: route.table });\r\n            }\r\n\r\n            //load shorthand routes\r\n            if (!lodash.isEmpty(route.routes)) {\r\n                const exAsync = Utils.expressHandler();\r\n                for (const path in route.routes) {\r\n                    const cfg = route.routes[path];\r\n                    for (const method in cfg) {\r\n                        const handler = cfg[method];\r\n                        if (Array.isArray(handler)) {\r\n                            //Securización (keycloak)\r\n                            router[method](path, handler[0], exAsync(handler[1]));\r\n                        } else {\r\n                            router[method](path, exAsync(handler));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (router) {\r\n                app.use(router);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Errores\r\n     */\r\n    errorHandler() {\r\n        // error handler\r\n        this.app.use((err, req, res, next) => {\r\n            let jsRes = new JsonResponse();\r\n            jsRes.success = false;\r\n            jsRes.message = err.message; //!FIXME protect error displaying in REST Responses\r\n            console.error(err);\r\n\r\n            res.status(500).json(jsRes.toJson());\r\n        });\r\n    }\r\n}\r\n","import http from \"http\";\r\nimport https from \"https\";\r\nimport fs from \"fs\";\r\nimport path from \"path\";\r\nimport cluster from \"cluster\";\r\nimport { Server } from \"socket.io\";\r\nimport os from \"os\";\r\nimport { EventEmitter } from \"events\";\r\n\r\nimport ClusterMessages from \"cluster-messages\";\r\n\r\n/**\r\n * Inicializa la escucha del server en modo cluster\r\n */\r\nexport default class ClusterServer extends EventEmitter {\r\n    constructor(app) {\r\n        super();\r\n\r\n        if (!process.env.PORT) {\r\n            console.log(\"Using 3000 as default port. Customize via env PORT.\");\r\n        }\r\n        this.port = this.normalizePort(process.env.PORT || 3000);\r\n        this.clustered = process.env.CLUSTERED;\r\n        this.workers = [];\r\n        this.app = app;\r\n\r\n        this.executeOnlyMain = () => {};\r\n    }\r\n\r\n    setServerCls(cls) {\r\n        this.server = cls;\r\n    }\r\n\r\n    /**\r\n     * Iniciar el servidor en el puerto y con la configuración seleccionadas.\r\n     */\r\n    async start() {\r\n        if (this.clustered == \"true\") {\r\n            this.initClustered();\r\n        } else {\r\n            this.configureSocketIO();\r\n            this.executeOnlyMain();\r\n\r\n            await this.initUnclustered();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Inicializa el servidor de socketio en el puerto siguiente al configurado.\r\n     *\r\n     * Se puede desactivar mediante la config socketio: false al realizar el App.init()\r\n     */\r\n    configureSocketIO() {\r\n        if (this.server.express_config && this.server.express_config.socketio) {\r\n            this.app.io = new Server(this.server.express_config && this.server.express_config.socketio);\r\n            this.app.io.listen(this.port + 1);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Inicializa la clase server encargada del control de las solicitudes en forma multiproceso.\r\n     *\r\n     */\r\n    async initClustered() {\r\n        //Launch cluster\r\n        if (cluster.isPrimary) {\r\n            this.configureSocketIO();\r\n\r\n            this.executeOnlyMain();\r\n\r\n            let messages = new ClusterMessages();\r\n            messages.on(\"event\", (msg, callback) => {\r\n                if (msg && msg.event) {\r\n                    if (process.env.DEBUG_EVENTS == true) {\r\n                        console.debug(`Received '${msg.event}' from ${msg.props.owner} at Master`);\r\n                    }\r\n                    //Desencadenar en el proceso principal tambien\r\n                    this.app.events.emit(msg.event, msg.props, callback);\r\n                }\r\n            });\r\n\r\n            //Count the machine's CPUs\r\n            const cpuCount = os.cpus().length;\r\n\r\n            //Create a worker for each CPU\r\n            for (let idx = 0; idx < cpuCount; idx += 1) {\r\n                this.initWorker();\r\n            }\r\n\r\n            //Listen for dying workers\r\n            cluster.on(\"exit\", (worker) => {\r\n                //Replace the dead worker, we're not sentimental\r\n                console.log(\"Worker \" + worker.id + \" died :(\");\r\n                this.initWorker();\r\n            });\r\n        } else {\r\n            await this.initUnclustered();\r\n            console.log(`Worker ${process.pid} started`);\r\n        }\r\n    }\r\n    /**\r\n     * Inicia un worker\r\n     */\r\n    initWorker() {\r\n        let worker = cluster.fork();\r\n        console.log(`Running worker ${worker.process.pid}`);\r\n\r\n        this.workers.push(worker);\r\n    }\r\n\r\n    /**\r\n     * Inicializa la clase server encargada del control de las solicitudes en un unico proceso.\r\n     *\r\n     */\r\n    async initUnclustered() {\r\n        this.server.port = this.port;\r\n        //create http server\r\n        let server = http.Server(this.server.app);\r\n\r\n        await this.server.initialize();\r\n\r\n        if (this.server.beforeListen) await this.server.beforeListen();\r\n        //listen on provided ports\r\n        server.listen(this.server.port);\r\n\r\n        if (this.server.afterListen) await this.server.afterListen();\r\n\r\n        //add error handler\r\n        server.on(\"error\", (err) => {\r\n            this.handleErrors(err, this.server.port);\r\n        });\r\n        //start listening on port\r\n        server.on(\"listening\", () => {\r\n            console.log(\"Server Worker running on port: \" + this.port + \"!\");\r\n            this.emit(\"listening\", this.port);\r\n        });\r\n\r\n        if (process.env.SSL && process.env.SSL == \"true\") {\r\n            if (!process.env.SSL_KEY || !process.env.SSL_CERT || !process.env.SSL_PASS) {\r\n                console.error(\"Invalid SSL configuration. SLL_KEY, SSL_CERT and SSL_PASS needed\");\r\n                process.exit(0);\r\n            }\r\n\r\n            var key = fs.readFileSync(path.resolve(process.cwd(), process.env.SSL_KEY || \"key.pem\"));\r\n            var cert = fs.readFileSync(path.resolve(process.cwd(), process.env.SSL_CERT || \"cert.pem\"));\r\n\r\n            var options = {\r\n                key: key,\r\n                cert: cert,\r\n                passphrase: process.env.SSL_PASS,\r\n            };\r\n\r\n            if (!process.env.SSL_PORT) {\r\n                console.log(\"Using 3443 as ssl default port. Customize via env SSL_PORT.\");\r\n            }\r\n            var sslPort = this.normalizePort(process.env.SSL_PORT || 3443);\r\n            var serverSsl = https.createServer(options, this.server.app);\r\n            serverSsl.listen(sslPort);\r\n            //add error handler\r\n            serverSsl.on(\"error\", (err) => {\r\n                this.handleErrors(err, sslPort);\r\n            });\r\n            //start listening on port\r\n            serverSsl.on(\"listening\", () => {\r\n                console.log(\"Server Worker running on port: \" + sslPort + \"!\");\r\n                this.emit(\"listening_ssl\", sslPort);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Controla los posibles errores de formato en el puerto\r\n     * @param val\r\n     * @returns {*}\r\n     */\r\n    normalizePort(val) {\r\n        let port = parseInt(val, 10);\r\n\r\n        if (isNaN(port)) {\r\n            //named pipe\r\n            return val;\r\n        }\r\n\r\n        if (port >= 0) {\r\n            //port number\r\n            return port;\r\n        }\r\n\r\n        return false;\r\n    }\r\n    /**\r\n     * Gestiona los errores en el listen del servidor\r\n     */\r\n    handleErrors(error, port) {\r\n        if (error.syscall !== \"listen\") {\r\n            throw error;\r\n        }\r\n\r\n        let bind = typeof port === \"string\" ? \"Pipe \" + port : \"Port \" + port;\r\n\r\n        //handle specific listen errors with friendly messages\r\n        switch (error.code) {\r\n            case \"EACCES\":\r\n                console.error(bind + \" requires elevated privileges\");\r\n                process.exit(1);\r\n                break;\r\n            case \"EADDRINUSE\":\r\n                console.error(bind + \" is already in use\");\r\n                process.exit(1);\r\n                break;\r\n            default:\r\n                throw error;\r\n        }\r\n    }\r\n}\r\n","import cluster from \"cluster\";\r\nimport { EventEmitter } from \"events\";\r\nimport ClusterMessages from \"cluster-messages\";\r\n\r\n/**\r\n * Clase encargada de la generacion de eventos.\r\n */\r\nexport default class EventHandler extends EventEmitter {\r\n    constructor(app) {\r\n        super();\r\n        this.messages = new ClusterMessages();\r\n\r\n        this.app = app; //Se recibe el singleton App para evitar referencias cruzadas\r\n\r\n        if (cluster.isWorker) {\r\n            // Levanto, en los worker, la escucha para recibir los eventos en broadcast de los demas hilos\r\n            this.messages.on(\"event\", (msg, callback) => {\r\n                if (msg && msg.event && process.pid !== msg.props.owner) {\r\n                    if (process.env.DEBUG_EVENTS == true) {\r\n                        console.debug(`Receiving broadcast ${msg.event} - ${process.pid}`);\r\n                    }\r\n                    super.emit(msg.event, { ...msg.props }, callback);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sobreescribir el emitter para notificar a los hijos\r\n     *\r\n     * @param {*} evt\r\n     * @param {*} props\r\n     */\r\n    emit(evt, props, callback) {\r\n        //Desencadenar en local\r\n        super.emit(evt, props, callback);\r\n\r\n        if (evt && props && cluster.isWorker && process.pid !== props.owner) {\r\n            if (process.env.DEBUG_EVENTS == true) {\r\n                console.debug(`${evt} -> Firing from ${process.pid} to master`);\r\n            }\r\n            if (!props) {\r\n                props = {};\r\n            }\r\n            props.owner = process.pid;\r\n            this.messages.send(\"event\", { event: evt, props: { ...props } }, callback);\r\n        }\r\n\r\n        if (evt && props && cluster.isPrimary && this.app && this.app.server && this.app.server.workers) {\r\n            if (process.env.DEBUG_EVENTS == true) {\r\n                console.debug(`${evt} -> Firing from master to workers`);\r\n            }\r\n            this.messages.send(\"event\", { event: evt, props: { ...props } }, callback);\r\n        }\r\n    }\r\n}\r\n","import log4js from \"log4js\";\r\nimport path from \"path\";\r\nimport fs from \"fs\";\r\nimport util from \"util\";\r\n\r\nconst { configure, getLogger } = log4js;\r\n\r\nexport default class Logger {\r\n    static async configure() {\r\n        const readfile = util.promisify(fs.readFile);\r\n\r\n        const json = await readfile(path.resolve(process.cwd(), \"./log4js.json\"), \"utf8\");\r\n\r\n        configure(JSON.parse(json));\r\n\r\n        //Nota para el futuro:\r\n        // Esto sobreescribe los metodos de console.log\r\n        // Es necesario que la sitaxis se mantenga tal cual....\r\n        (() => {\r\n            const log_logger = getLogger(\"log\");\r\n            const error_logger = getLogger(\"error\");\r\n            const debug_logger = getLogger(\"debug\");\r\n            console.log = function () {\r\n                let args = Array.prototype.slice.call(arguments);\r\n                // log.apply(this, args);\r\n                log_logger.log(\"info\", args[0]);\r\n            };\r\n            console.error = function () {\r\n                let args = Array.prototype.slice.call(arguments);\r\n                // error.apply(this, args);\r\n                error_logger.log(\"error\", args[0]);\r\n            };\r\n            console.info = function () {\r\n                let args = Array.prototype.slice.call(arguments);\r\n                // info.apply(this, args);\r\n                log_logger.log(\"info\", args[0]);\r\n            };\r\n            console.debug = function () {\r\n                /*if (global.settings.debug.value) {*/\r\n                let args = Array.prototype.slice.call(arguments);\r\n                // debug.apply(this, [args[1], args[2]]);\r\n                debug_logger.log(\"debug\", args[0]);\r\n            };\r\n\r\n            console.custom = function (logger, level, message) {\r\n                const custom_logger = getLogger(logger);\r\n                custom_logger.log(level, message);\r\n            };\r\n        })();\r\n    }\r\n}\r\n","import express from \"express\";\r\nimport url from \"url\";\r\nimport { JsonResponse, Utils } from \"../common/index.js\";\r\n\r\nimport { pathToRegexp } from \"path-to-regexp\";\r\n\r\nexport default class AuthController {\r\n    constructor(publicPathsList, AuthHandler) {\r\n        this.router = express.Router();\r\n        this.publicPathsList = [...publicPathsList, \"/login\"];\r\n\r\n        this.AuthHandler = AuthHandler;\r\n    }\r\n\r\n    configure() {\r\n        const exAsync = Utils.expressHandler();\r\n        this.router.use(exAsync((...args) => this.check(...args)));\r\n        this.router.post(\r\n            \"/login\",\r\n            exAsync((...args) => this.loginPost(...args))\r\n        );\r\n        this.router.post(\r\n            \"/logout\",\r\n            exAsync((...args) => this.logout(...args))\r\n        );\r\n\r\n        return this.router;\r\n    }\r\n\r\n    /**\r\n     * Controla que los usuarios tengan sesion para acceder a los metodos privados de la API\r\n     *\r\n     * @param {*} request\r\n     * @param {*} response\r\n     * @param {*} next\r\n     */\r\n    async check(request, response, next) {\r\n        try {\r\n            //Rutas ublicas\r\n            for (let path of this.publicPathsList) {\r\n                const expr = pathToRegexp(path);\r\n                if (expr.exec(url.parse(request.url).pathname) !== null) {\r\n                    return next();\r\n                }\r\n            }\r\n\r\n            if (await this.AuthHandler.check(request)) {\r\n                return next();\r\n            }\r\n\r\n            return response.status(403).json(new JsonResponse(false, null, \"Forbidden\").toJson());\r\n        } catch (ex) {\r\n            console.error(ex);\r\n            return response.status(403).json(new JsonResponse(false, null, \"Forbidden\").toJson());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Valida los credenciales de un usuario\r\n     *\r\n     * TODO logger console.custom(\"access\", INFO);\r\n     *\r\n     * @param {*} request\r\n     * @param {*} response\r\n     */\r\n    async loginPost(request, response) {\r\n        if (request.body.username) {\r\n            try {\r\n                let data = await this.AuthHandler.validate(request, request.body.username, request.body.password);\r\n                if (data) {\r\n                    return response.status(200).json(new JsonResponse(true, data).toJson());\r\n                }\r\n                return response.status(401).json(new JsonResponse(false, null, \"Unauthorized - Incorrect credentials\").toJson());\r\n            } catch (ex) {\r\n                console.error(ex);\r\n                return response.status(401).json(new JsonResponse(false, null, \"Unauthorized - Error, check log\").toJson());\r\n            }\r\n        }\r\n        return response.status(401).json(new JsonResponse(false, null, \"Unauthorized - Missing parameters\").toJson());\r\n    }\r\n\r\n    /**\r\n     * Cierra la sesion del usuario\r\n     *\r\n     * @param {*} request\r\n     * @param {*} response\r\n     */\r\n    async logout(request, response) {\r\n        if (this.AuthHandler.logout) {\r\n            //Depende de que el authHandler implementado pueda realizar esta accion\r\n            try {\r\n                await this.AuthHandler.logout(request);\r\n                return response.status(200).json(new JsonResponse(true).toJson());\r\n            } catch (ex) {\r\n                console.error(ex);\r\n                return response.status(500).json(new JsonResponse(false, null, ex).toJson());\r\n            }\r\n        }\r\n        return response.status(200).json(new JsonResponse(true).toJson());\r\n    }\r\n}\r\n","export default class IAuthHandler {\r\n    constructor() {\r\n        if (!this.check) {\r\n            throw new Error(\"AuthHandler must have 'check' vethod\");\r\n        }\r\n        if (!this.validate) {\r\n            throw new Error(\"AuthHandler must have 'validate' vethod\");\r\n        }\r\n        // logout method is optional\r\n    }\r\n}\r\n\r\n","import { TokenGenerator, Utils } from '../../common/index.js';\r\nimport IAuthHandler from '../IAuthHandler.js'\r\nimport lodash from 'lodash';\r\nimport moment from 'moment';\r\n\r\nexport default class JwtAuthHandler extends IAuthHandler {\r\n    constructor(UserDao) {\r\n        super();\r\n\r\n        this.tokenGenerator = new TokenGenerator(process.env.JWT_SECRET, { audience: process.env.JWT_AUDIENCE, issuer: process.env.JWT_ISSUER, subject: process.env.JWT_SUBJECT, algorithm: process.env.JWT_ALGORITHM, expiresIn: process.env.JWT_EXPIRES })\r\n\r\n        if (!UserDao) {\r\n            throw new Error(\"Need 'UserDao' for user validation. Create 'UserDao' class extending 'IUserDao'\");\r\n        }\r\n        this.userDao = UserDao;\r\n    }\r\n\r\n    /**\r\n     * Metodo encargado de realizar la comprobacion para validar si la sesion del usuario es válida\r\n     * \r\n     * @param {*} request \r\n     */\r\n    async check(request) {\r\n        if (request.headers.authorization) {\r\n            const token = (request.headers.authorization || '').split(' ')[1] || '';\r\n\r\n            if (!token) {\r\n                console.error(\"Token needed\");\r\n                return false;\r\n            }\r\n            try {\r\n                var decoded = this.tokenGenerator.verify(token);\r\n                const { sub, username, exp } = decoded;\r\n\r\n                if (!sub || !username || moment(exp).isAfter(new Date())) {\r\n                    return false;\r\n                }\r\n\r\n                //Si la sesion es valida, lo introducimos en el contexto de la solicitud\r\n                request.session = { ...request.session, ...decoded };\r\n                return true;\r\n            } catch (ex) {\r\n                console.error(ex);\r\n                return false;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Método encargado de realizar la validación de un usuario. Utiliza IUserDao como interfaz para la realización de la query a BD.\r\n     * \r\n     * @param {*} username \r\n     * @param {*} password \r\n     */\r\n    async validate(request, username, password) {\r\n\r\n        const user = await this.userDao.findByUsername(username);\r\n\r\n        if (user && user.username === username && user.password === Utils.encrypt(password)) {\r\n            return this.tokenGenerator.sign(lodash.omit(user, ['password']));\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n}","import { Utils } from \"../../common/index.js\";\r\nimport IAuthHandler from \"../IAuthHandler.js\";\r\nimport lodash from \"lodash\";\r\n\r\n/**\r\n * Necesario:\r\n *  Instalar -->   express-session y algun session store\r\n * \r\n *  Mas info: https://www.npmjs.com/package/express-session\r\n * \r\n *  App.customizeExpress = () => {\r\n       this.app.use(session({\r\n            secret: 'keyboard cat',\r\n            resave: false,\r\n            saveUninitialized: true,\r\n            cookie: { secure: true }\r\n        }));\r\n    }\r\n */\r\n\r\nexport default class CookieAuthHandler extends IAuthHandler {\r\n    constructor(UserDao) {\r\n        super();\r\n\r\n        if (!UserDao) {\r\n            throw new Error(\"Need 'UserDao' for user validation. Create 'UserDao' class extending 'IUserDao'\");\r\n        }\r\n        this.userDao = UserDao;\r\n    }\r\n\r\n    /**\r\n     * Metodo encargado de realizar la comprobacion para validar si la sesion del usuario es válida\r\n     *\r\n     * @param {*} request\r\n     */\r\n    async check(request) {\r\n        if (request.headers.authorization) {\r\n            //Si se recibe por Auth Basic\r\n            const token = (request.headers.authorization || \"\").split(\" \")[1] || \"\";\r\n\r\n            const creds = Buffer.from(token, \"base64\").toString().split(\":\");\r\n            const login = creds[0];\r\n            const password = creds[1];\r\n\r\n            if (!(await this.validate(request, login, password))) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        if (request.session && request.session.username) {\r\n            //Si hay sesion almacenada\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Método encargado de realizar la validación de un usuario. Utiliza IUserDao como interfaz para la realización de la query a BD.\r\n     *\r\n     * @param {*} username\r\n     * @param {*} password\r\n     */\r\n    async validate(request, username, password) {\r\n        const user = await this.userDao.findByUsername(username);\r\n\r\n        if (user && user.username === username && user.password === Utils.encrypt(password)) {\r\n            request.session = { ...request.session, ...lodash.omit(user, [\"password\"]) };\r\n\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {*} request\r\n     */\r\n    logout(request) {\r\n        return new Promise((resolve) => {\r\n            if (request.session) {\r\n                request.session.destroy(resolve);\r\n            }\r\n        });\r\n    }\r\n}\r\n","import Knex from 'knex'\r\n\r\nclass KnexConnector {\r\n\r\n\r\n    init(config) {\r\n\r\n        /**\r\n         * References the current connection of the app\r\n         * @type {Knex}\r\n         * @public\r\n         */\r\n        this.connection = Knex(config)\r\n    }\r\n\r\n    /**\r\n     * Configura de forma global los aliases de las columnas para utilizar en FQL.\r\n     * \r\n     * La estructura es \r\n     * {\r\n            \"table1\": {\r\n                \"alias1\": \"column1\",\r\n                \"alias2\": \"column2\"\r\n            },\r\n            \"table2\": {\r\n                \"alias1\": \"column1\"\r\n            }\r\n        }\r\n     *\r\n     * @param {*} aliases \r\n     */\r\n    setColumnAliases(aliases) {\r\n        this.columnAliases = aliases;\r\n    }\r\n    \r\n\r\n\r\n    test() {\r\n        return this.connection.raw('select 1+1 as result');\r\n    }\r\n}\r\n\r\n\r\nexport default new KnexConnector();","import { Utils } from \"../../../common/index.js\";\r\n\r\nimport { FQLParser, KnexParser } from \"@landra_sistemas/fql-parser\";\r\nimport KnexConnector from \"../KnexConnector.js\";\r\n\r\nexport default class KnexFilterParser {\r\n    /**\r\n     *\r\n     * @param {*} builder\r\n     * @param {*} string\r\n     * @returns\r\n     */\r\n    static parseQueryString(builder, string, tableName) {\r\n        const options = {\r\n            allowGlobalSearch: true,\r\n            caseInsensitive: true,\r\n        };\r\n        //Agregar los aliases en caso de que se hayan configurado de forma global\r\n        if (KnexConnector.columnAliases && KnexConnector.columnAliases[tableName]) {\r\n            options.aliases = KnexConnector.columnAliases[tableName];\r\n        }\r\n        //Options\r\n        if (KnexConnector.caseInsensitive !== undefined) {\r\n            options.caseInsensitive = KnexConnector.caseInsensitive;\r\n        }\r\n        if (KnexConnector.allowGlobalSearch !== undefined) {\r\n            options.allowGlobalSearch = KnexConnector.allowGlobalSearch;\r\n        }\r\n        const parser = new FQLParser(options);\r\n        const data = parser.parse(string);\r\n\r\n        return new KnexParser(tableName).toKnex(builder, data);\r\n    }\r\n\r\n    /**\r\n     * Convierte un objeto clave valor en un conjunto de filtros.\r\n     *\r\n     * - Filtro estandar:\r\n     *    filters: {\r\n     *       \"column\": \"value\" -> filtro generico exact\r\n     *    }\r\n     * - Filtro Objeto:\r\n     *    filters:{\r\n     *       \"column\": {\r\n     *       \"type\": \"date|between|exists|notexists|greater|greaterEq|less|lessEq|exact|exactI|not|null|notnull|like|likeI\"\r\n     *       \"start\": \"xxx\", //inicio de rango para el filtro de date y between\r\n     *       \"end\": \"xxx\", //fin de rango para el filtro date y between\r\n     *       \"value\": \"xxx\" //valor a utilizar para el resto de filtros\r\n     *     }\r\n     * }\r\n     *  - Filtro Lista:\r\n     *     filters: {\r\n     *       \"column\": [1, 2, 3]\r\n     *     }\r\n     *    Filtro de tipo IN, todos los elementos que coincidan\r\n     *\r\n     * - Definicion de tipos:\r\n     *    date: filtro de fechas desde y hasta\r\n     *    between: filtro entre dos valores concretos\r\n     *    exists: busca si existe la propiedad\r\n     *    notexists: busca si existe la propiedad\r\n     *    greater: mayor que\r\n     *    greaterEq: mayor o igual que\r\n     *    less: menor que\r\n     *    lessEq: menor o igual que\r\n     *    exact: valor exacto\r\n     *    exactI: valor exacto ignorando mayusculas y minusculas\r\n     *    not: distinto de\r\n     *    null: igual a null\r\n     *    notnull: distinto de null\r\n     *    like: filtro like\r\n     *    likeI: filtro like ignorando mayusculas y minusculas\r\n     */\r\n    static parseFilters(builder, filter, tableName) {\r\n        let query = builder;\r\n\r\n        for (let prop in filter) {\r\n            let elm = filter[prop];\r\n\r\n            if (typeof elm === \"object\") {\r\n                switch (elm.type) {\r\n                    case \"fql\":\r\n                        query = KnexFilterParser.parseQueryString(query, elm.value, tableName);\r\n                        break;\r\n                    case \"date\":\r\n                    case \"between\":\r\n                        if (elm.start && elm.end) {\r\n                            query = query.whereBetween(prop, [elm.start, elm.end]);\r\n                        }\r\n                        if (elm.start && !elm.end) {\r\n                            query = query.where(prop, \">=\", elm.start);\r\n                        }\r\n                        if (!elm.start && elm.end) {\r\n                            query = query.where(prop, \">=\", elm.end);\r\n                        }\r\n                        break;\r\n                    case \"dateraw\":\r\n                    case \"betweenraw\":\r\n                        if (elm.start && elm.end) {\r\n                            query = query.whereRaw(`${prop} BETWEEN ? AND ?`, [elm.start, elm.end]);\r\n                        }\r\n                        if (elm.start && !elm.end) {\r\n                            query = query.whereRaw(`${prop} >= ?`, [elm.start]);\r\n                        }\r\n                        if (!elm.start && elm.end) {\r\n                            query = query.whereRaw(`${prop} >= ?`, [elm.end]);\r\n                        }\r\n                        break;\r\n                    case \"jsonb\":\r\n                        query = query.whereRaw(`${prop} ILIKE ?`, [\"%\" + elm.value + \"%\"]);\r\n                        break;\r\n                    case \"full-text-psql\":\r\n                        query = query.whereRaw(`to_tsvector(${prop}::text) @@ to_tsquery(?)`, [elm.value]);\r\n                        break;\r\n\r\n                    case \"greater\":\r\n                    case \"greaterraw\":\r\n                        query = query.whereRaw(`${prop} > ?`, [elm.value]);\r\n                        break;\r\n                    case \"greaterEq\":\r\n                    case \"greaterEqraw\":\r\n                        query = query.whereRaw(`${prop} >= ?`, [elm.value]);\r\n                        break;\r\n                    case \"less\":\r\n                    case \"lessraw\":\r\n                        query = query.whereRaw(`${prop} < ?`, [elm.value]);\r\n                        break;\r\n                    case \"lessEq\":\r\n                    case \"lessEqraw\":\r\n                        query = query.whereRaw(`${prop} <= ?`, [elm.value]);\r\n                        break;\r\n                    case \"exists\":\r\n                        query = query.whereExists(prop);\r\n                        break;\r\n                    case \"notexists\":\r\n                        query = query.whereNotExists(prop);\r\n                        break;\r\n                    case \"exact\":\r\n                    case \"exactraw\":\r\n                        query = query.whereRaw(`${prop} = ?`, [elm.value]);\r\n                        break;\r\n                    case \"in\":\r\n                        let propComplex = prop;\r\n                        if (propComplex.includes(\",\")) {\r\n                            propComplex = prop.split(\",\");\r\n                        }\r\n                        if (!Array.isArray(elm.value) && elm.value != undefined) {\r\n                            query = query.whereIn(propComplex, elm.value.split(\",\"));\r\n                        } else {\r\n                            if (elm.value != undefined) {\r\n                                query = query.whereIn(propComplex, elm.value);\r\n                            }\r\n                        }\r\n                        break;\r\n                    case \"inraw\":\r\n                        if (!Array.isArray(elm.value) && elm.value != undefined) {\r\n                            query = query.whereRaw(`${prop} IN (?)`, [\r\n                                elm.value\r\n                                    .split(\",\")\r\n                                    .map((e) => `'${e}'`)\r\n                                    .join(\",\"),\r\n                            ]);\r\n                        } else {\r\n                            if (elm.value != undefined) {\r\n                                query = query.whereRaw(`${prop} IN (?)`, [elm.value.map((e) => `'${e}'`).join(\",\")]);\r\n                            }\r\n                        }\r\n                        break;\r\n                    case \"not\":\r\n                    case \"notraw\":\r\n                        query = query.whereRaw(`${prop} != ?`, [elm.value]);\r\n                        break;\r\n                    case \"like\":\r\n                    case \"likeraw\":\r\n                        let value_likeraw = Utils.replaceAll(elm.value, \"*\", \"%\");\r\n                        query = query.whereRaw(` ${prop} LIKE ?`, [value_likeraw]);\r\n                        break;\r\n                    case \"notlike\":\r\n                    case \"notlikeraw\":\r\n                        let value_nolikeraw = Utils.replaceAll(elm.value, \"*\", \"%\");\r\n                        query = query.whereRaw(` ${prop} NOT LIKE ?`, [value_nolikeraw]);\r\n                        break;\r\n                    case \"likeI\":\r\n                        let value_rawilike = Utils.replaceAll(elm.value, \"*\", \"%\");\r\n                        query = query.whereRaw(` ${prop} ILIKE ?`, [value_rawilike]);\r\n                        break;\r\n                    case \"notlikeI\":\r\n                        let value_notrawilike = Utils.replaceAll(elm.value, \"*\", \"%\");\r\n                        query = query.whereRaw(` ${prop} NOT ILIKE ?`, [value_notrawilike]);\r\n                        break;\r\n                    case \"null\":\r\n                    case \"nullraw\":\r\n                        query = query.whereRaw(`${prop} is NULL`);\r\n                        break;\r\n                    case \"notnull\":\r\n                    case \"notnullraw\":\r\n                        query = query.whereRaw(`${prop} is not NULL`);\r\n                        break;\r\n                }\r\n            } else {\r\n                //Si el valor no es un objeto se devuelve\r\n                query = query.where(prop, elm);\r\n            }\r\n        }\r\n\r\n        // console.log(query.toSQL());\r\n        return query;\r\n    }\r\n\r\n    /**\r\n     * Conversion de un objeto {property: XX, direction: ASC|DESC - ascend|descend} a un ORDER BY\r\n     *\r\n     * @param {*} sorts\r\n     */\r\n    static parseSort(sort) {\r\n        if (!sort.field || !sort.direction) {\r\n            return 1;\r\n        }\r\n\r\n        let direction = \"ASC\";\r\n        if (sort.direction === \"descend\") {\r\n            direction = \"DESC\";\r\n        }\r\n\r\n        return sort.field + \" \" + direction;\r\n    }\r\n}\r\n","import KnexFilterParser from \"../filters/KnexFilterParser.js\";\r\nimport KnexConnector from \"../KnexConnector.js\";\r\n\r\nimport lodash from \"lodash\";\r\n\r\n/**\r\n * Crear un dao con los métodos básicos\r\n */\r\nexport default class BaseKnexDao {\r\n    constructor() {\r\n        this.tableName = \"\";\r\n    }\r\n\r\n    loadAllData(start, limit) {\r\n        return KnexConnector.connection\r\n            .select(\"*\")\r\n            .from(this.tableName)\r\n            .limit(limit || 10000)\r\n            .offset(start);\r\n    }\r\n\r\n    async loadFilteredData(filters, start, limit) {\r\n        let sorts = 1;\r\n        if (filters.sort) {\r\n            sorts = KnexFilterParser.parseSort(filters.sort);\r\n        }\r\n\r\n        return KnexConnector.connection\r\n            .from(this.tableName)\r\n            .where((builder) => KnexFilterParser.parseFilters(builder, lodash.omit(filters, [\"sort\", \"start\", \"limit\"]), this.tableName))\r\n            .orderByRaw(sorts)\r\n            .limit(limit)\r\n            .offset(start);\r\n    }\r\n\r\n    async countFilteredData(filters) {\r\n        let data = await KnexConnector.connection\r\n            .from(this.tableName)\r\n            .where((builder) => KnexFilterParser.parseFilters(builder, lodash.omit(filters, [\"sort\", \"start\", \"limit\"]), this.tableName))\r\n            .count(\"id\", { as: \"total\" });\r\n\r\n        return data && data[0].total;\r\n    }\r\n\r\n    async loadById(objectId) {\r\n        const data = await KnexConnector.connection.from(this.tableName).where(\"id\", objectId);\r\n\r\n        if (data && data[0]) {\r\n            return data[0];\r\n        }\r\n        return null;\r\n    }\r\n\r\n    save(object) {\r\n        return KnexConnector.connection.from(this.tableName).insert(object).returning(\"*\");\r\n    }\r\n    update(objectId, newObject) {\r\n        return KnexConnector.connection.from(this.tableName).where(\"id\", objectId).update(newObject).returning(\"*\");\r\n    }\r\n    async delete(objectId) {\r\n        const existing = await this.loadById(objectId);\r\n        if (!existing) {\r\n            throw \"NotFound\";\r\n        }\r\n        return KnexConnector.connection.from(this.tableName).where(\"id\", objectId).delete();\r\n    }\r\n}\r\n","import BaseKnexDao from \"./knex/dao/BaseKnexDao.js\";\r\n\r\nexport default class IUserDao extends BaseKnexDao {\r\n    constructor(tableName) {\r\n        super(tableName);\r\n\r\n        if (!this.findByUsername) {\r\n            throw new Error(\"AuthHandler must have 'findByUsername' method\");\r\n        }\r\n    }\r\n}\r\n","import express from \"express\";\r\nimport { JsonResponse, Utils } from \"../common/index.js\";\r\n\r\nexport class BaseController {\r\n    constructor() {\r\n        this.router = express.Router();\r\n        this.routes = {};\r\n        //Example routes shorthand\r\n        /*\r\n         {\r\n            \"/\": {\r\n                \"get\": this.listEntidad.bind(this),\r\n                \"post\": this.listEntidad.bind(this)\r\n            }\r\n         } \r\n         */\r\n    }\r\n\r\n    configure(entity, config) {\r\n        if (!entity) {\r\n            return this.router;\r\n        }\r\n\r\n        const exAsync = Utils.expressHandler();\r\n        this.router.get(\r\n            `/${entity}`,\r\n            exAsync((...args) => this.listEntidad(...args))\r\n        );\r\n        this.router.post(\r\n            `/${entity}/list`,\r\n            exAsync((...args) => this.listEntidad(...args))\r\n        );\r\n        this.router.get(\r\n            `/${entity}/:id`,\r\n            exAsync((...args) => this.getEntidad(...args))\r\n        );\r\n        this.router.post(\r\n            `/${entity}`,\r\n            exAsync((...args) => this.saveEntidad(...args))\r\n        );\r\n        this.router.put(\r\n            `/${entity}/:id`,\r\n            exAsync((...args) => this.updateEntidad(...args))\r\n        );\r\n        this.router.delete(\r\n            `/${entity}/:id`,\r\n            exAsync((...args) => this.deleteEntidad(...args))\r\n        );\r\n\r\n        this.service = config.service;\r\n        this.table = config.table;\r\n\r\n        return this.router;\r\n    }\r\n\r\n    /**\r\n     * Lista entidades en la aplicacion, es posible enviarle parametros de filtrado.\r\n     *\r\n     *\r\n     * @api {post} /:entidad/list Listar entidades\r\n     * @apiName Listar entidades\r\n     * @apiGroup Comun\r\n     * @apiPermission Auth Basic username:pwd\r\n     * @apiParam {Number} id entidades unique ID.\r\n     *\r\n     * @apiSuccess {Boolean} success\r\n     * @apiSuccess {Object[]} data  dataObject\r\n     */\r\n    async listEntidad(request, response, next) {\r\n        try {\r\n            let service = new this.service(null, this.table);\r\n            let filters = request.method === \"POST\" ? request.body : request.query && request.query.filters ? JSON.parse(request.query.filters) : {};\r\n\r\n            let data = await service.list(filters, filters.start, filters.limit);\r\n            let jsRes = new JsonResponse(true, data.data, null, data.total);\r\n\r\n            response.json(jsRes.toJson());\r\n        } catch (e) {\r\n            next(e);\r\n        }\r\n    }\r\n    /**\r\n     *Obtiene un elemento concreto mediante su identificador\r\n     *\r\n     *\r\n     * @api {get} /:entidad/:id Obtener entidad\r\n     * @apiName Obtener entidad\r\n     * @apiGroup Comun\r\n     * @apiPermission Auth Basic username:pwd\r\n     * @apiParam {Number} id entidades unique ID.\r\n     *\r\n     * @apiSuccess {Boolean} success\r\n     * @apiSuccess {Object[]} data  dataObject\r\n     */\r\n    async getEntidad(request, response, next) {\r\n        try {\r\n            let service = new this.service(null, this.table);\r\n            let data = await service.loadById(request.params.id);\r\n            let jsRes = new JsonResponse(true, data);\r\n            let code = 200;\r\n            if (data == null) {\r\n                code = 404;\r\n                let message = \"Element not found\";\r\n                jsRes = new JsonResponse(false, null, message, 0);\r\n            }\r\n\r\n            response.status(code).json(jsRes.toJson());\r\n        } catch (e) {\r\n            console.error(e);\r\n            let message = \"\";\r\n            if (e.code == \"22P02\") {\r\n                //PostgreSQL error Code form string_to_UUID\r\n                message = \"Expected uiid\";\r\n            }\r\n            let jsRes = new JsonResponse(false, null, message, 0);\r\n            response.status(400).json(jsRes.toJson());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Almacena un elemento en BD\r\n     *\r\n     *\r\n     * @api {post} /:entidad/:id Crear entidad\r\n     * @apiName Crear entidad\r\n     * @apiGroup Comun\r\n     * @apiPermission Auth Basic username:pwd\r\n     * @apiParam {Number} id entidades unique ID.\r\n     *\r\n     * @apiSuccess {Boolean} success\r\n     * @apiSuccess {Object[]} data  dataObject\r\n     */\r\n    async saveEntidad(request, response, next) {\r\n        try {\r\n            let service = new this.service(null, this.table);\r\n\r\n            let data = await service.save(request.body);\r\n            let jsRes = new JsonResponse(true, (data && data[0]) || { id: request.body.id });\r\n\r\n            response.setHeader(\"Location\", `/entity/${jsRes.data.id}`);\r\n            response.status(201).json(jsRes.toJson());\r\n        } catch (e) {\r\n            next(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Almacena un elemento en BD\r\n     *\r\n     *\r\n     * @api {put} /:entidad/:id Actualizar entidad\r\n     * @apiName Actualizar entidad\r\n     * @apiGroup Comun\r\n     * @apiPermission Auth Basic username:pwd\r\n     * @apiParam {Number} id entidades unique ID.\r\n     *\r\n     * @apiSuccess {Boolean} success\r\n     * @apiSuccess {Object[]} data  dataObject\r\n     */\r\n    async updateEntidad(request, response, next) {\r\n        try {\r\n            let service = new this.service(null, this.table);\r\n\r\n            let data = await service.update(request.params.id, request.body);\r\n            let jsRes = new JsonResponse(true, (data && data[0]) || { id: request.body.id });\r\n\r\n            response.json(jsRes.toJson());\r\n        } catch (e) {\r\n            next(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Elimina un elemento correspondiente al identificador recibido\r\n     *\r\n     *\r\n     * @api {delete} /:entidad/:id/delete Delete entidad\r\n     * @apiName Eliminar entidad\r\n     * @apiGroup Comun\r\n     * @apiPermission Auth Basic username:pwd\r\n     * @apiParam {Number} id entidades unique ID.\r\n     *\r\n     * @apiSuccess {Boolean} success\r\n     * @apiSuccess {Object[]} data  dataObject\r\n     */\r\n    async deleteEntidad(request, response, next) {\r\n        try {\r\n            let service = new this.service(null, this.table);\r\n            let data = await service.delete(request.params.id);\r\n            let jsRes = new JsonResponse(true, data);\r\n\r\n            response.status(204).json(jsRes.toJson());\r\n        } catch (e) {\r\n            console.error(e);\r\n            if (e == \"NotFound\") {\r\n                let message = \"Element not found\";\r\n                let jsRes = new JsonResponse(false, null, message, 0);\r\n                response.status(404).json(jsRes.toJson());\r\n            } else {\r\n                next(e);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { BaseKnexDao } from \"../db/index.js\";\r\n\r\nexport class BaseService {\r\n    constructor(cls, table) {\r\n        if (cls) {\r\n            this.dao = new cls();\r\n        } else {\r\n            this.dao = new BaseKnexDao(); //El sistema por defecto utiliza knex, si se pasa un dao personalizado se puede sobreescribir este comportamiento\r\n        }\r\n        if (table) {\r\n            this.dao.tableName = table;\r\n        }\r\n    }\r\n    /**\r\n     * Obtencion de una lista de elementos.\r\n     *\r\n     * filters, es opcional. Si no se pasan se devuelve lo que hay ;\r\n     */\r\n    async list(filters, start, limit) {\r\n        //Pagination\r\n        const st = start || 0;\r\n        const lm = limit || 1000; //Default limit\r\n\r\n        let response = {};\r\n        response.total = await this.dao.countFilteredData(filters, st, lm);\r\n\r\n        if (filters && Object.keys(filters).length !== 0) {\r\n            let filteredData = await this.dao.loadFilteredData(filters, st, lm);\r\n            response.data = filteredData;\r\n            return response;\r\n        }\r\n\r\n        response.data = await this.dao.loadAllData(start, limit);\r\n        return response;\r\n    }\r\n\r\n    /**\r\n     * Obtencion de un elemento mediante su identificador\r\n     */\r\n    loadById(id) {\r\n        return this.dao.loadById(id);\r\n    }\r\n    /**\r\n     * Metodo de creacion.\r\n     *\r\n     * Si el identificador se pasa como undefined se creara un nuevo elemento,\r\n     * sino se modifica el correspondiente.\r\n     */\r\n    save(data) {\r\n        //Create\r\n        return this.dao.save(data);\r\n    }\r\n    /**\r\n     * Metodo de creacion.\r\n     *\r\n     * Si el identificador se pasa como undefined se creara un nuevo elemento,\r\n     * sino se modifica el correspondiente.\r\n     */\r\n    update(id, data) {\r\n        if (id) {\r\n            //Update\r\n            return this.dao.update(id, data);\r\n        }\r\n    }\r\n    /**\r\n     * Metodo de eliminado.\r\n     *\r\n     * El identificador es obligatorio para poder localizar el elemento a eliminar.\r\n     */\r\n    delete(id) {\r\n        if (id) {\r\n            return this.dao.delete(id);\r\n        }\r\n    }\r\n}\r\n","import { I18nLoader, Utils } from \"./common/index.js\";\r\nimport { EventHandler } from \"./events/index.js\";\r\nimport { ClusterServer, Server } from \"./server/index.js\";\r\nimport { Logger } from \"./logger/index.js\";\r\n\r\nimport net from \"net\";\r\nimport repl from \"repl\";\r\nimport { KnexConnector } from \"./db/index.js\";\r\nimport Runtime from \"./common/Runtime.js\";\r\n\r\nclass App {\r\n    constructor() {\r\n        this.serverClass = Server;\r\n        this.clusterClass = ClusterServer;\r\n    }\r\n\r\n    /**\r\n     * Inicializa la runtime de la aplicación para poder recibir parámetros por consola y generar claves.\r\n     * @returns\r\n     */\r\n    runtime(extra) {\r\n        return Runtime(extra);\r\n    }\r\n\r\n    /**\r\n     * Initializa las configuraciones para la app\r\n     *\r\n     */\r\n    async init(serverConfig) {\r\n        if (process.env.DISABLE_LOGGER != \"true\") {\r\n            await Logger.configure();\r\n        }\r\n\r\n        //Instanciar la clase server\r\n        const server = new this.serverClass(serverConfig, this.statics, this.routes);\r\n        if (this.customizeExpress) {\r\n            server.customizeExpress = this.customizeExpress;\r\n        }\r\n        if (this.beforeListen) {\r\n            server.beforeListen = this.beforeListen;\r\n        }\r\n        if (this.afterListen) {\r\n            server.afterListen = this.afterListen;\r\n        }\r\n\r\n        /**\r\n         * Gestor de eventos\r\n         * @type {EventHandler}\r\n         * @public\r\n         */\r\n        this.events = new EventHandler(this);\r\n\r\n        /**\r\n         * Gestor de traducciones\r\n         * @type {I18nLoader}\r\n         * @public\r\n         */\r\n        this.i18n = new I18nLoader(serverConfig?.disableI18nWatcher);\r\n        await this.i18n.load();\r\n        /**\r\n         * Servidor actual\r\n         * @type {ClusterServer}\r\n         * @public\r\n         */\r\n        this.server = new this.clusterClass(this);\r\n\r\n        this.server.setServerCls(server);\r\n        this.server.executeOnlyMain = () => {\r\n            if (this.executeOnlyMain) this.executeOnlyMain();\r\n\r\n            if (process.env.REPL_ENABLED == \"true\") {\r\n                this.startRepl();\r\n            }\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Ejecuta el servidor con la configuracion de #init()\r\n     */\r\n    async start() {\r\n        if (!this.server) {\r\n            throw new Error(\"Call init first\");\r\n        }\r\n        await this.server.start();\r\n    }\r\n\r\n    /**\r\n     * Inicia el server replify para poder conectar terminales remotas\r\n     *\r\n     *\r\n     * Para que arranque es necesario especificar REPL_ENABLED en el archivo .env\r\n     */\r\n    startRepl() {\r\n        try {\r\n            net.createServer((socket) => {\r\n                const remote = repl.start({\r\n                    prompt: \"lisco::remote> \",\r\n                    input: socket,\r\n                    output: socket,\r\n                    terminal: true,\r\n                    useColors: true,\r\n                    preview: false,\r\n                });\r\n                remote.context.app = this;\r\n                remote.context.Utils = Utils;\r\n                remote.context.db = KnexConnector.connection;\r\n                remote.on(\"exit\", socket.end.bind(socket));\r\n            }).listen(process.env.REPL_PORT || 5001);\r\n        } catch (e) {\r\n            console.log(\"Remote REPL Conn: \" + e);\r\n        }\r\n\r\n        console.log(`Remote REPL started on port ${process.env.REPL_PORT || 5001}`);\r\n    }\r\n}\r\n\r\nexport default new App();\r\n","import Utils from \"./Utils.js\";\r\n\r\nimport yargs from \"yargs/yargs\";\r\nimport { hideBin } from \"yargs/helpers\";\r\n\r\n/**\r\n * Extra puede ser un array de objetos con la siguiente estructura:\r\n *\r\n * {\r\n *  \"key\": \"c\",\r\n *  \"alias\": \"config\",\r\n *  \"describe\": \"Configuración\",\r\n *  \"fn\": function(argv) { },\r\n *  \"nargs\": 0,\r\n *  \"required\": true\r\n * }\r\n * @param {*} extra\r\n * @returns\r\n */\r\nexport default async function Runtime(extra) {\r\n    const cfg = yargs(hideBin(process.argv))\r\n        .usage(\r\n            `Como usar: \r\n            node $0 [options] \r\n            \r\n            ** Si no se especifican parámetros el servidor arrancará normalmente. **`\r\n        )\r\n        .alias(\"g\", \"generateKeys\")\r\n        .describe(\"g\", \"Genera unas claves para la aplicación\")\r\n        .alias(\"c\", \"encrypt\")\r\n        .describe(\"c\", \"Codifica el String proporcionado en base a la contraseña de .env\")\r\n        .nargs(\"c\", 1)\r\n        .help(\"h\")\r\n        .alias(\"h\", \"help\");\r\n\r\n    let demand = [];\r\n    if (extra) {\r\n        for (const param of extra) {\r\n            cfg.alias(param.key, param.alias);\r\n            if (param.describe) {\r\n                cfg.describe(param.key, param.describe);\r\n            }\r\n            if (param.nargs !== 0) {\r\n                cfg.nargs(param.key, param.nargs);\r\n            }\r\n            if (param.boolean) {\r\n                cfg.boolean(param.key);\r\n            }\r\n            if (param.choices) {\r\n                cfg.choices(param.key, param.choices);\r\n            }\r\n            if (param.required) {\r\n                demand.push(param.key);\r\n            }\r\n        }\r\n    }\r\n\r\n    if (demand.length !== 0) {\r\n        cfg.demandOption(demand);\r\n    }\r\n\r\n    const argv = cfg.argv;\r\n    //Parámetro para no arrancar el servidor y generar las claves JWT\r\n    if (argv.generateKeys) {\r\n        console.log(\"Generando claves para encriptación:\");\r\n        console.log(Utils.generateKeys());\r\n        return process.exit(1);\r\n    }\r\n\r\n    if (argv.encrypt) {\r\n        console.log(\"Resultado encryptación:\");\r\n        console.log(Utils.encrypt(argv.encrypt));\r\n        return process.exit(1);\r\n    }\r\n\r\n    if (extra) {\r\n        for (const param of extra) {\r\n            if (argv[param.key]) {\r\n                await param.fn(argv);\r\n                return process.exit(1);\r\n            }\r\n        }\r\n    }\r\n}\r\n"],"names":["Utils","static","mcArray","join","toLowerCase","split","str","find","replace","RegExp","text","secret","Buffer","from","process","env","CRYPT_SECRET","iv","CRYPT_IV","cipher","crypto","createCipheriv","encrypted","update","concat","final","toString","encryptedText","decipher","createDecipheriv","decrypted","ms","util","promisify","setTimeout","promise_sleep","key","randomBytes","ob","flatObject","toReturn","i","hasOwnProperty","Array","constructor","flattenObject","x","isNaN","data","result","keys","reduce","r","e","j","Number","length","fn","args","fnReturn","next","Promise","resolve","catch","I18nLoader","disableWatchers","this","watcher","async","custom","lang","DEFAULT_LANG","currentData","currentDataFlat","file","cwd","chokidar","watch","ignored","persistent","on","path","loadFile","readfile","fs","readFile","parsedData","JSON","parse","ex","code","console","log","error","load","JsonResponse","success","message","total","toJson","buffer","copyProps","src","dst","SafeBuffer","arg","encodingOrOffset","alloc","allocUnsafe","allocUnsafeSlow","module","exports","TypeError","size","fill","encoding","buf","undefined","SlowBuffer","require$$0","DataStream","writable","readable","pipe","nextTick","emit","bind","inherits","Stream","prototype","write","end","dataStream","bufferEqualConstantTime","bufferEq","a","b","isBuffer","c","install","equal","that","origBufEqual","origSlowBufEqual","getParamSize","keySize","restore","paramBytesForAlg","ES256","ES384","ES512","paramBytesForAlg_1","alg","paramBytes","Error","signatureAsBuffer","signature","countPadding","start","stop","padding","ecdsaSigFormatter","getParamBytesForAlg","maxEncodedParamLength","inputLength","offset","seqLength","TAG_INT","rLength","rOffset","sLength","sOffset","rPadding","sPadding","copy","Math","max","o","MSG_INVALID_SECRET","MSG_INVALID_VERIFIER_KEY","supportsKeyObjects","createPublicKey","checkIsPublicKey","typeError","type","asymmetricKeyType","export","checkIsPrivateKey","fromBase64","base64","toBase64","base64url","template","slice","call","arguments","errMsg","format","apply","normalizeInput","thing","obj","stringify","createHmacSigner","bits","checkIsSecretKey","hmac","createHmac","digest","createHmacVerifier","computedSig","bufferEqual","createKeySigner","privateKey","signer","createSign","sign","createKeyVerifier","publicKey","verifier","createVerify","verify","createPSSKeySigner","constants","RSA_PKCS1_PSS_PADDING","saltLength","RSA_PSS_SALTLEN_DIGEST","createPSSKeyVerifier","createECDSASigner","inner","formatEcdsa","createECDSAVerifer","signatureBytes","rsBytes","shortLength","MAX_OCTET","createNoneSigner","createNoneVerifier","jwa","algorithm","signerFactories","hs","rs","ps","es","none","verifierFactories","match","algo","tostring","string","jwsSign","opts","header","payload","secretOrKey","securedInput","encodedHeader","encodedPayload","jwsSecuredInput","SignStream","secretStream","once","signStream","JWS_REGEX","headerFromJWS","jwsSig","Object","isObject","safeJsonParse","signatureFromJWS","isValidJws","test","jwsVerify","err","securedInputFromJWS","jwsDecode","payloadFromJWS","typ","json","VerifyStream","valid","decode","isValid","verifyStream","JsonWebTokenError","captureStackTrace","name","create","JsonWebTokenError_1","NotBeforeError","date","NotBeforeError_1","TokenExpiredError","expiredAt","TokenExpiredError_1","s","m","h","d","plural","msAbs","n","isPlural","round","timespan","time","iat","timestamp","floor","Date","now","milliseconds","val","options","String","exec","parseFloat","isFinite","long","abs","fmtShort","MAX_LENGTH","MAX_SAFE_COMPONENT_LENGTH","MAX_SAFE_BUILD_LENGTH","MAX_SAFE_INTEGER","RELEASE_TYPES","SEMVER_SPEC_VERSION","FLAG_INCLUDE_PRERELEASE","FLAG_LOOSE","debug_1","NODE_DEBUG","re","safeRe","t","R","safeRegexReplacements","createToken","value","isGlobal","safe","token","makeSafeRegex","index","debug","NUMERICIDENTIFIER","NUMERICIDENTIFIERLOOSE","NONNUMERICIDENTIFIER","PRERELEASEIDENTIFIER","PRERELEASEIDENTIFIERLOOSE","BUILDIDENTIFIER","MAINVERSION","PRERELEASE","BUILD","FULLPLAIN","MAINVERSIONLOOSE","PRERELEASELOOSE","LOOSEPLAIN","XRANGEIDENTIFIER","XRANGEIDENTIFIERLOOSE","GTLT","XRANGEPLAIN","XRANGEPLAINLOOSE","COERCE","LONETILDE","tildeTrimReplace","LONECARET","caretTrimReplace","comparatorTrimReplace","looseOption","freeze","loose","emptyOpts","parseOptions_1","numeric","compareIdentifiers","anum","bnum","identifiers","rcompareIdentifiers","require$$1","require$$2","SemVer","version","parseOptions","includePrerelease","trim","LOOSE","FULL","raw","major","minor","patch","prerelease","map","id","num","build","compare","other","compareMain","comparePre","compareBuild","inc","release","identifier","identifierBase","base","push","semver","compare_1","cmp_1","op","eq","neq","gt","gte","lt","lte","yallist","Yallist","list","self","tail","head","forEach","item","l","Node","unshift","prev","removeNode","node","unshiftNode","pushNode","pop","res","shift","thisp","walker","forEachReverse","get","getReverse","mapReverse","initial","acc","reduceReverse","toArray","arr","toArrayReverse","to","ret","sliceReverse","splice","deleteCount","nodes","inserted","reverse","p","Symbol","iterator","er","MAX","LENGTH","LENGTH_CALCULATOR","ALLOW_STALE","MAX_AGE","DISPOSE","NO_DISPOSE_ON_SET","LRU_LIST","CACHE","UPDATE_AGE_ON_GET","naiveLength","doUse","hit","isStale","del","maxAge","diff","delete","Entry","forEachStep","Range","range","Comparator","set","parseRange","filter","first","isNullSet","isAny","comps","memoKey","cached","cache","HYPHENRANGELOOSE","HYPHENRANGE","hyphenReplace","COMPARATORTRIM","TILDETRIM","CARETTRIM","rangeList","comp","parseComparator","replaceGTE0","COMPARATORLOOSE","rangeMap","Map","comparators","has","values","intersects","some","thisComparators","isSatisfiable","rangeComparators","every","thisComparator","rangeComparator","testSet","Infinity","lc","stale","dispose","noDisposeOnSet","updateAgeOnGet","reset","mL","allowStale","mA","lengthCalculator","lC","itemCount","rforEach","k","dump","v","dumpLru","len","peek","expiresAt","prune","remainingComparators","testComparator","otherComparator","replaceCarets","replaceTildes","replaceXRanges","replaceStars","isX","replaceTilde","TILDELOOSE","TILDE","_","M","pr","replaceCaret","z","CARETLOOSE","CARET","replaceXRange","XRANGELOOSE","XRANGE","gtlt","xM","xm","xp","STAR","GTE0PRE","GTE0","incPr","$0","fM","fm","fp","fpr","fb","tM","tm","tp","tpr","tb","ANY","allowed","operator","COMPARATOR","cmp","startsWith","includes","comparator","asymmetricKeyDetailsSupported","rsaPssKeyDetailsSupported","allowedAlgorithmsForKeys","ec","rsa","allowedCurves","validateAsymmetricKey","keyType","allowedAlgorithms","ASYMMETRIC_KEY_DETAILS_SUPPORTED","allowedCurve","asymmetricKeyDetails","namedCurve","RSA_PSS_KEY_DETAILS_SUPPORTED","parseInt","hashAlgorithm","mgf1HashAlgorithm","psSupported","KeyObject","createSecretKey","PUB_KEY_ALGS","EC_KEY_ALGS","RSA_KEY_ALGS","HS_ALGS","PS_SUPPORTED","reTrim","reIsBadHex","reIsBinary","reIsOctal","reIsUint","freeParseInt","baseIsNaN","func","transform","objectProto","objectToString","propertyIsEnumerable","nativeKeys","nativeMax","isIndex","isArray","isArrayLike","isLength","tag","isFunction","isObjectLike","lodash_isboolean","lodash_isinteger","isSymbol","valueOf","isBinary","toNumber","toFinite","remainder","toInteger","lodash_isnumber","funcToString","Function","objectCtorString","getPrototype","overArg","getPrototypeOf","lodash_isplainobject","isHostObject","proto","Ctor","lodash_isstring","createPrivateKey","SUPPORTED_ALGS","sign_options_schema","expiresIn","isInteger","isString","notBefore","audience","collection","fromIndex","guard","object","props","array","iteratee","arrayMap","baseValues","inherited","isArrayLikeObject","isArguments","baseTimes","skipIndexes","arrayLikeKeys","baseKeys","indexOf","predicate","fromRight","baseFindIndex","baseIndexOf","isPlainObject","issuer","subject","jwtid","noTimestamp","isBoolean","keyid","mutatePayload","allowInsecureKeySizes","allowInvalidAsymmetricKeyTypes","registered_claims_schema","isNumber","exp","nbf","validate","schema","allowUnknown","parameterName","validator","options_to_payload","options_for_objects","jsonwebtoken","jwtString","secretOrPublicKey","callback","done","assign","clockTimestamp","nonce","parts","decodedToken","jwt","decoded","jws","complete","getSecret","secretCallback","hasSignature","algorithms","ignoreNotBefore","clockTolerance","ignoreExpiration","audiences","aud","targetAudience","iss","sub","jti","maxAgeTimestamp","secretOrPrivateKey","isObjectPayload","kid","failure","modulusLength","validatePayload","invalid_options","opt","validateOptions","claim","before","TokenGenerator","jwtSignOptions","_extends","uuid","v4","refresh","Server","config","statics","routes","app","express","express_config","lodash","defaultsDeep","helmet","urlencoded","compression","cors","origin","credentials","fileupload","socketio","transports","traceRequests","customizeExpress","configureRoutes","errorHandler","use","extended","fileUpload","idx","DISABLE_LOGGER","request","response","requestTime","pathname","url","pid","method","session","user_id","body","router","Router","loadRoutes","route","warn","configure","entity","service","table","isEmpty","exAsync","expressHandler","cfg","handler","req","jsRes","status","ClusterServer","EventEmitter","super","PORT","port","normalizePort","clustered","CLUSTERED","workers","executeOnlyMain","setServerCls","cls","server","initClustered","configureSocketIO","initUnclustered","io","listen","cluster","isPrimary","ClusterMessages","msg","event","DEBUG_EVENTS","owner","events","cpuCount","os","cpus","initWorker","worker","fork","http","initialize","beforeListen","afterListen","handleErrors","SSL","SSL_KEY","SSL_CERT","SSL_PASS","exit","readFileSync","cert","passphrase","SSL_PORT","sslPort","serverSsl","https","createServer","syscall","EventHandler","messages","isWorker","evt","send","getLogger","log4js","Logger","log_logger","error_logger","debug_logger","info","logger","level","AuthController","publicPathsList","AuthHandler","check","post","loginPost","logout","pathToRegexp","username","password","IAuthHandler","JwtAuthHandler","UserDao","tokenGenerator","JWT_SECRET","JWT_AUDIENCE","JWT_ISSUER","JWT_SUBJECT","JWT_ALGORITHM","JWT_EXPIRES","userDao","headers","authorization","moment","isAfter","user","findByUsername","encrypt","omit","CookieAuthHandler","creds","login","destroy","KnexConnector$1","init","connection","Knex","setColumnAliases","aliases","columnAliases","KnexFilterParser","builder","tableName","allowGlobalSearch","caseInsensitive","KnexConnector","FQLParser","KnexParser","toKnex","query","prop","elm","parseQueryString","whereBetween","where","whereRaw","whereExists","whereNotExists","propComplex","whereIn","value_likeraw","replaceAll","value_nolikeraw","value_rawilike","value_notrawilike","sort","field","direction","BaseKnexDao","loadAllData","limit","select","filters","sorts","parseSort","parseFilters","orderByRaw","count","as","objectId","save","insert","returning","newObject","loadById","IUserDao","BaseController","listEntidad","getEntidad","saveEntidad","put","updateEntidad","deleteEntidad","params","setHeader","BaseService","dao","st","lm","countFilteredData","filteredData","loadFilteredData","App$1","serverClass","clusterClass","runtime","extra","yargs","hideBin","argv","usage","alias","describe","nargs","help","demand","param","boolean","choices","required","demandOption","generateKeys","Runtime","serverConfig","i18n","disableI18nWatcher","REPL_ENABLED","startRepl","net","socket","remote","repl","prompt","input","output","terminal","useColors","preview","context","db","REPL_PORT"],"mappings":"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"}